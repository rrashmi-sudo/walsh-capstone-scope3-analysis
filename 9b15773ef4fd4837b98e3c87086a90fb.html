<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>b65e65d341de43bc9f86f93de1210a85</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell markdown" id="bykKe-27eSN1">
<h2 id="title-supply-chain-prediction"><strong>Title: Supply chain
prediction</strong></h2>
<p>#R Rashmi</p>
<h1 id="11-02-2026">11-02-2026</h1>
</div>
<div class="cell code" id="IuQ20JV7ey2V">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&#39;ignore&#39;</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">&quot;whitegrid&quot;</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">&quot;display.float_format&quot;</span>, <span class="st">&quot;</span><span class="sc">{:.3e}</span><span class="st">&quot;</span>.<span class="bu">format</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">&quot;whitegrid&quot;</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">&quot;display.max_columns&quot;</span>, <span class="va">None</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">&quot;display.float_format&quot;</span>, <span class="st">&quot;</span><span class="sc">{:.4e}</span><span class="st">&quot;</span>.<span class="bu">format</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="ZfQMObW8ex-m">
<p><strong>1. Data Loading and Exploration.</strong></p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:74}"
id="xpznts7rd0zx" data-outputId="e48224bf-a639-429d-97ca-dfcc392732bb">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> files</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>uploaded <span class="op">=</span> files.upload()</span></code></pre></div>
<div class="output display_data">

     <input type="file" id="files-6a8b02a3-dedc-4f93-882e-1bd8a2048c1b" name="files[]" multiple disabled
        style="border:none" />
     <output id="result-6a8b02a3-dedc-4f93-882e-1bd8a2048c1b">
      Upload widget is only available when the cell has been executed in the
      current browser session. Please rerun this cell to enable.
      </output>
      <script>// Copyright 2017 Google LLC
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

/**
 * @fileoverview Helpers for google.colab Python module.
 */
(function(scope) {
function span(text, styleAttributes = {}) {
  const element = document.createElement('span');
  element.textContent = text;
  for (const key of Object.keys(styleAttributes)) {
    element.style[key] = styleAttributes[key];
  }
  return element;
}

// Max number of bytes which will be uploaded at a time.
const MAX_PAYLOAD_SIZE = 100 * 1024;

function _uploadFiles(inputId, outputId) {
  const steps = uploadFilesStep(inputId, outputId);
  const outputElement = document.getElementById(outputId);
  // Cache steps on the outputElement to make it available for the next call
  // to uploadFilesContinue from Python.
  outputElement.steps = steps;

  return _uploadFilesContinue(outputId);
}

// This is roughly an async generator (not supported in the browser yet),
// where there are multiple asynchronous steps and the Python side is going
// to poll for completion of each step.
// This uses a Promise to block the python side on completion of each step,
// then passes the result of the previous step as the input to the next step.
function _uploadFilesContinue(outputId) {
  const outputElement = document.getElementById(outputId);
  const steps = outputElement.steps;

  const next = steps.next(outputElement.lastPromiseValue);
  return Promise.resolve(next.value.promise).then((value) => {
    // Cache the last promise value to make it available to the next
    // step of the generator.
    outputElement.lastPromiseValue = value;
    return next.value.response;
  });
}

/**
 * Generator function which is called between each async step of the upload
 * process.
 * @param {string} inputId Element ID of the input file picker element.
 * @param {string} outputId Element ID of the output display.
 * @return {!Iterable<!Object>} Iterable of next steps.
 */
function* uploadFilesStep(inputId, outputId) {
  const inputElement = document.getElementById(inputId);
  inputElement.disabled = false;

  const outputElement = document.getElementById(outputId);
  outputElement.innerHTML = '';

  const pickedPromise = new Promise((resolve) => {
    inputElement.addEventListener('change', (e) => {
      resolve(e.target.files);
    });
  });

  const cancel = document.createElement('button');
  inputElement.parentElement.appendChild(cancel);
  cancel.textContent = 'Cancel upload';
  const cancelPromise = new Promise((resolve) => {
    cancel.onclick = () => {
      resolve(null);
    };
  });

  // Wait for the user to pick the files.
  const files = yield {
    promise: Promise.race([pickedPromise, cancelPromise]),
    response: {
      action: 'starting',
    }
  };

  cancel.remove();

  // Disable the input element since further picks are not allowed.
  inputElement.disabled = true;

  if (!files) {
    return {
      response: {
        action: 'complete',
      }
    };
  }

  for (const file of files) {
    const li = document.createElement('li');
    li.append(span(file.name, {fontWeight: 'bold'}));
    li.append(span(
        `(${file.type || 'n/a'}) - ${file.size} bytes, ` +
        `last modified: ${
            file.lastModifiedDate ? file.lastModifiedDate.toLocaleDateString() :
                                    'n/a'} - `));
    const percent = span('0% done');
    li.appendChild(percent);

    outputElement.appendChild(li);

    const fileDataPromise = new Promise((resolve) => {
      const reader = new FileReader();
      reader.onload = (e) => {
        resolve(e.target.result);
      };
      reader.readAsArrayBuffer(file);
    });
    // Wait for the data to be ready.
    let fileData = yield {
      promise: fileDataPromise,
      response: {
        action: 'continue',
      }
    };

    // Use a chunked sending to avoid message size limits. See b/62115660.
    let position = 0;
    do {
      const length = Math.min(fileData.byteLength - position, MAX_PAYLOAD_SIZE);
      const chunk = new Uint8Array(fileData, position, length);
      position += length;

      const base64 = btoa(String.fromCharCode.apply(null, chunk));
      yield {
        response: {
          action: 'append',
          file: file.name,
          data: base64,
        },
      };

      let percentDone = fileData.byteLength === 0 ?
          100 :
          Math.round((position / fileData.byteLength) * 100);
      percent.textContent = `${percentDone}% done`;

    } while (position < fileData.byteLength);
  }

  // All done.
  yield {
    response: {
      action: 'complete',
    }
  };
}

scope.google = scope.google || {};
scope.google.colab = scope.google.colab || {};
scope.google.colab._files = {
  _uploadFiles,
  _uploadFilesContinue,
};
})(self);
</script> 
</div>
<div class="output stream stdout">
<pre><code>Saving SupplyChain.xlsx to SupplyChain.xlsx
</code></pre>
</div>
</div>
<div class="cell code" id="adhTvI_IYwBe">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>pd.read_excel(<span class="bu">next</span>(<span class="bu">iter</span>(uploaded)))</span></code></pre></div>
</div>
<div class="cell code" id="6davp_ASa9xi">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>file_path <span class="op">=</span> <span class="bu">list</span>(uploaded.keys())[<span class="dv">0</span>]</span></code></pre></div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="TFQawGibbJHO" data-outputId="57a90fd6-8243-475e-8a38-7599a6d3799e">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>xls <span class="op">=</span> pd.ExcelFile(file_path)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>xls.sheet_names</span></code></pre></div>
<div class="output execute_result" data-execution_count="6">
<pre><code>[&#39;GHG&#39;, &#39;CO2&#39;]</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:311}"
id="r3etrSBtWusD" data-outputId="f89e77e3-dcfd-4cd7-bf46-52b187a1954f">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df_ghg <span class="op">=</span> pd.read_excel(file_path, sheet_name<span class="op">=</span><span class="st">&quot;GHG&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df_co2e <span class="op">=</span> pd.read_excel(file_path, sheet_name<span class="op">=</span><span class="st">&quot;CO2&quot;</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>df_ghg.head()</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>df_co2e.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="7">

  <div id="df-815a3b5e-b996-41f5-8462-7a2e2c493600" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>2017 NAICS Code</th>
      <th>2017 NAICS Title</th>
      <th>GHG</th>
      <th>Unit</th>
      <th>Supply Chain Emission Factors without Margins</th>
      <th>Margins of Supply Chain Emission Factors</th>
      <th>Supply Chain Emission Factors with Margins</th>
      <th>Reference USEEIO Code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>111110</td>
      <td>Soybean Farming</td>
      <td>All GHGs</td>
      <td>kg CO2e/2022 USD, purchaser price</td>
      <td>4.8800e-01</td>
      <td>4.4000e-02</td>
      <td>5.3200e-01</td>
      <td>1111A0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>111120</td>
      <td>Oilseed (except Soybean) Farming</td>
      <td>All GHGs</td>
      <td>kg CO2e/2022 USD, purchaser price</td>
      <td>4.8800e-01</td>
      <td>4.4000e-02</td>
      <td>5.3200e-01</td>
      <td>1111A0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>111130</td>
      <td>Dry Pea and Bean Farming</td>
      <td>All GHGs</td>
      <td>kg CO2e/2022 USD, purchaser price</td>
      <td>8.0900e-01</td>
      <td>4.0000e-02</td>
      <td>8.4800e-01</td>
      <td>1111B0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>111140</td>
      <td>Wheat Farming</td>
      <td>All GHGs</td>
      <td>kg CO2e/2022 USD, purchaser price</td>
      <td>8.0900e-01</td>
      <td>4.0000e-02</td>
      <td>8.4800e-01</td>
      <td>1111B0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>111150</td>
      <td>Corn Farming</td>
      <td>All GHGs</td>
      <td>kg CO2e/2022 USD, purchaser price</td>
      <td>8.0900e-01</td>
      <td>4.0000e-02</td>
      <td>8.4800e-01</td>
      <td>1111B0</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-815a3b5e-b996-41f5-8462-7a2e2c493600')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-815a3b5e-b996-41f5-8462-7a2e2c493600 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-815a3b5e-b996-41f5-8462-7a2e2c493600');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>

</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="fW-axbOae7pA" data-outputId="c852dbab-60e5-481c-d645-9619dbd7281a">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_ghg.columns.tolist())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[&#39;2017 NAICS Code&#39;, &#39;2017 NAICS Title&#39;, &#39;GHG&#39;, &#39;Unit&#39;, &#39;Supply Chain Emission Factors without Margins&#39;, &#39;Margins of Supply Chain Emission Factors&#39;, &#39;Supply Chain Emission Factors with Margins&#39;, &#39;Reference USEEIO Code&#39;]
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="AvTEEVkke-Ka" data-outputId="d4b93fd4-965a-4215-db0c-4cd42a0a32ad">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_co2e.columns.tolist())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[&#39;2017 NAICS Code&#39;, &#39;2017 NAICS Title&#39;, &#39;GHG&#39;, &#39;Unit&#39;, &#39;Supply Chain Emission Factors without Margins&#39;, &#39;Margins of Supply Chain Emission Factors&#39;, &#39;Supply Chain Emission Factors with Margins&#39;, &#39;Reference USEEIO Code&#39;]
</code></pre>
</div>
</div>
<div class="cell code" id="WYmvtXGTT9gJ">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> inspect_df(df, name):</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">--- </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> DATASET ---&quot;</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Shape:&quot;</span>, df.shape)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Data types:&quot;</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df.dtypes)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Missing values:&quot;</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df.isna().<span class="bu">sum</span>())</span></code></pre></div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="7LVGj-FBT9bz" data-outputId="6ebe0860-e13f-48b1-c4d7-f5997279c85e">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>inspect_df(df_ghg, <span class="st">&quot;GHG&quot;</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>inspect_df(df_co2e, <span class="st">&quot;CO2e&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>
--- GHG DATASET ---
Shape: (18288, 8)

Data types:
2017 NAICS Code                                    int64
2017 NAICS Title                                  object
GHG                                               object
Unit                                              object
Supply Chain Emission Factors without Margins    float64
Margins of Supply Chain Emission Factors         float64
Supply Chain Emission Factors with Margins       float64
Reference USEEIO Code                             object
dtype: object

Missing values:
2017 NAICS Code                                  0
2017 NAICS Title                                 0
GHG                                              0
Unit                                             0
Supply Chain Emission Factors without Margins    0
Margins of Supply Chain Emission Factors         0
Supply Chain Emission Factors with Margins       0
Reference USEEIO Code                            0
dtype: int64

--- CO2e DATASET ---
Shape: (1016, 8)

Data types:
2017 NAICS Code                                    int64
2017 NAICS Title                                  object
GHG                                               object
Unit                                              object
Supply Chain Emission Factors without Margins    float64
Margins of Supply Chain Emission Factors         float64
Supply Chain Emission Factors with Margins       float64
Reference USEEIO Code                             object
dtype: object

Missing values:
2017 NAICS Code                                  0
2017 NAICS Title                                 0
GHG                                              0
Unit                                             0
Supply Chain Emission Factors without Margins    0
Margins of Supply Chain Emission Factors         0
Supply Chain Emission Factors with Margins       0
Reference USEEIO Code                            0
dtype: int64
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="58_h3cTkT9Xx" data-outputId="cc55a906-8e00-41f3-fdc7-b511cdc23d6e">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>standard_cols <span class="op">=</span> {</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;2017 NAICS Code&quot;</span>: <span class="st">&quot;naics_code&quot;</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;2017 NAICS Title&quot;</span>: <span class="st">&quot;naics_title&quot;</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;GHG&quot;</span>: <span class="st">&quot;ghg_type&quot;</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Unit&quot;</span>: <span class="st">&quot;unit&quot;</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Supply Chain Emission Factors without Margins&quot;</span>: <span class="st">&quot;emission_without_margins&quot;</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Margins of Supply Chain Emission Factors&quot;</span>: <span class="st">&quot;margin_emissions&quot;</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Supply Chain Emission Factors with Margins&quot;</span>: <span class="st">&quot;emission_with_margins&quot;</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Reference USEEIO Code&quot;</span>: <span class="st">&quot;useeio_code&quot;</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>df_ghg <span class="op">=</span> df_ghg.rename(columns<span class="op">=</span>standard_cols)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>df_co2e <span class="op">=</span> df_co2e.rename(columns<span class="op">=</span>standard_cols)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>df_ghg.head()</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>df_co2e.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="12">

  <div id="df-7e8c1a9a-e879-4127-9d05-07baf275b3ef" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>naics_code</th>
      <th>naics_title</th>
      <th>ghg_type</th>
      <th>unit</th>
      <th>emission_without_margins</th>
      <th>margin_emissions</th>
      <th>emission_with_margins</th>
      <th>useeio_code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>111110</td>
      <td>Soybean Farming</td>
      <td>All GHGs</td>
      <td>kg CO2e/2022 USD, purchaser price</td>
      <td>4.8800e-01</td>
      <td>4.4000e-02</td>
      <td>5.3200e-01</td>
      <td>1111A0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>111120</td>
      <td>Oilseed (except Soybean) Farming</td>
      <td>All GHGs</td>
      <td>kg CO2e/2022 USD, purchaser price</td>
      <td>4.8800e-01</td>
      <td>4.4000e-02</td>
      <td>5.3200e-01</td>
      <td>1111A0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>111130</td>
      <td>Dry Pea and Bean Farming</td>
      <td>All GHGs</td>
      <td>kg CO2e/2022 USD, purchaser price</td>
      <td>8.0900e-01</td>
      <td>4.0000e-02</td>
      <td>8.4800e-01</td>
      <td>1111B0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>111140</td>
      <td>Wheat Farming</td>
      <td>All GHGs</td>
      <td>kg CO2e/2022 USD, purchaser price</td>
      <td>8.0900e-01</td>
      <td>4.0000e-02</td>
      <td>8.4800e-01</td>
      <td>1111B0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>111150</td>
      <td>Corn Farming</td>
      <td>All GHGs</td>
      <td>kg CO2e/2022 USD, purchaser price</td>
      <td>8.0900e-01</td>
      <td>4.0000e-02</td>
      <td>8.4800e-01</td>
      <td>1111B0</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-7e8c1a9a-e879-4127-9d05-07baf275b3ef')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-7e8c1a9a-e879-4127-9d05-07baf275b3ef button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-7e8c1a9a-e879-4127-9d05-07baf275b3ef');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>

</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:424}"
id="IZWpHDs0T9Tr" data-outputId="f50a1b6b-ea28-42e3-9a44-c47d6f69c083">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_types(df):</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">&quot;naics_code&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;naics_code&quot;</span>].astype(<span class="bu">int</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">&quot;naics_title&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;naics_title&quot;</span>].astype(<span class="st">&quot;category&quot;</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">&quot;unit&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;unit&quot;</span>].astype(<span class="st">&quot;category&quot;</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">&quot;useeio_code&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;useeio_code&quot;</span>].astype(<span class="st">&quot;category&quot;</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>df_ghg <span class="op">=</span> clean_types(df_ghg)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>df_co2e <span class="op">=</span> clean_types(df_co2e)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>df_ghg</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>df_co2e</span></code></pre></div>
<div class="output execute_result" data-execution_count="13">

  <div id="df-210826fb-b425-4c9d-8ab2-cc88803533f6" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>naics_code</th>
      <th>naics_title</th>
      <th>ghg_type</th>
      <th>unit</th>
      <th>emission_without_margins</th>
      <th>margin_emissions</th>
      <th>emission_with_margins</th>
      <th>useeio_code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>111110</td>
      <td>Soybean Farming</td>
      <td>All GHGs</td>
      <td>kg CO2e/2022 USD, purchaser price</td>
      <td>4.8800e-01</td>
      <td>4.4000e-02</td>
      <td>5.3200e-01</td>
      <td>1111A0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>111120</td>
      <td>Oilseed (except Soybean) Farming</td>
      <td>All GHGs</td>
      <td>kg CO2e/2022 USD, purchaser price</td>
      <td>4.8800e-01</td>
      <td>4.4000e-02</td>
      <td>5.3200e-01</td>
      <td>1111A0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>111130</td>
      <td>Dry Pea and Bean Farming</td>
      <td>All GHGs</td>
      <td>kg CO2e/2022 USD, purchaser price</td>
      <td>8.0900e-01</td>
      <td>4.0000e-02</td>
      <td>8.4800e-01</td>
      <td>1111B0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>111140</td>
      <td>Wheat Farming</td>
      <td>All GHGs</td>
      <td>kg CO2e/2022 USD, purchaser price</td>
      <td>8.0900e-01</td>
      <td>4.0000e-02</td>
      <td>8.4800e-01</td>
      <td>1111B0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>111150</td>
      <td>Corn Farming</td>
      <td>All GHGs</td>
      <td>kg CO2e/2022 USD, purchaser price</td>
      <td>8.0900e-01</td>
      <td>4.0000e-02</td>
      <td>8.4800e-01</td>
      <td>1111B0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1011</th>
      <td>813910</td>
      <td>Business Associations</td>
      <td>All GHGs</td>
      <td>kg CO2e/2022 USD, purchaser price</td>
      <td>1.2800e-01</td>
      <td>0.0000e+00</td>
      <td>1.2800e-01</td>
      <td>813B00</td>
    </tr>
    <tr>
      <th>1012</th>
      <td>813920</td>
      <td>Professional Organizations</td>
      <td>All GHGs</td>
      <td>kg CO2e/2022 USD, purchaser price</td>
      <td>1.2800e-01</td>
      <td>0.0000e+00</td>
      <td>1.2800e-01</td>
      <td>813B00</td>
    </tr>
    <tr>
      <th>1013</th>
      <td>813930</td>
      <td>Labor Unions and Similar Labor Organizations</td>
      <td>All GHGs</td>
      <td>kg CO2e/2022 USD, purchaser price</td>
      <td>1.2800e-01</td>
      <td>0.0000e+00</td>
      <td>1.2800e-01</td>
      <td>813B00</td>
    </tr>
    <tr>
      <th>1014</th>
      <td>813940</td>
      <td>Political Organizations</td>
      <td>All GHGs</td>
      <td>kg CO2e/2022 USD, purchaser price</td>
      <td>1.2800e-01</td>
      <td>0.0000e+00</td>
      <td>1.2800e-01</td>
      <td>813B00</td>
    </tr>
    <tr>
      <th>1015</th>
      <td>813990</td>
      <td>Other Similar Organizations (except Business, ...</td>
      <td>All GHGs</td>
      <td>kg CO2e/2022 USD, purchaser price</td>
      <td>1.2800e-01</td>
      <td>0.0000e+00</td>
      <td>1.2800e-01</td>
      <td>813B00</td>
    </tr>
  </tbody>
</table>
<p>1016 rows × 8 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-210826fb-b425-4c9d-8ab2-cc88803533f6')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-210826fb-b425-4c9d-8ab2-cc88803533f6 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-210826fb-b425-4c9d-8ab2-cc88803533f6');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


  <div id="id_56556530-4b4e-4615-961c-2b0dca1b4561">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_co2e')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_56556530-4b4e-4615-961c-2b0dca1b4561 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_co2e');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="BQahZEi8T9PI" data-outputId="639949bb-1389-4917-b076-4e72a9d2e045">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> validate_emissions(df):</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">&quot;calc_total&quot;</span>] <span class="op">=</span> (</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&quot;emission_without_margins&quot;</span>] <span class="op">+</span> df[<span class="st">&quot;margin_emissions&quot;</span>]</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">&quot;diff&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;emission_with_margins&quot;</span>] <span class="op">-</span> df[<span class="st">&quot;calc_total&quot;</span>]</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df[<span class="st">&quot;diff&quot;</span>].<span class="bu">abs</span>().<span class="bu">max</span>()</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;GHG max diff:&quot;</span>, validate_emissions(df_ghg))</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;CO2e max diff:&quot;</span>, validate_emissions(df_co2e))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>GHG max diff: 0.0046999999999999265
CO2e max diff: 0.001000000000000112
</code></pre>
</div>
</div>
<div class="cell markdown" id="9XiU63i4yu1c">
<p>Differences ≈ 0 → internal consistency confirmed.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="C_7fO8EDT9LB" data-outputId="13ef7f62-85e6-4ad8-e5c5-dfe30e7cefc9">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;GHG duplicates:&quot;</span>,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>      df_ghg.duplicated(subset<span class="op">=</span>[<span class="st">&quot;naics_code&quot;</span>, <span class="st">&quot;ghg_type&quot;</span>]).<span class="bu">sum</span>())</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;CO2e duplicates:&quot;</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>      df_co2e.duplicated(subset<span class="op">=</span>[<span class="st">&quot;naics_code&quot;</span>]).<span class="bu">sum</span>())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>GHG duplicates: 0
CO2e duplicates: 0
</code></pre>
</div>
</div>
<div class="cell markdown" id="bb6sdjbBzWZ-">
<p><strong>Exploratory Data Analysis (EDA)</strong></p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:301}"
id="-Txg2XfOT9G8" data-outputId="93a2926e-127f-44b2-f2cb-78041d37153e">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df_ghg[[</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;emission_without_margins&quot;</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;margin_emissions&quot;</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;emission_with_margins&quot;</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>]].describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="16">

  <div id="df-5819cb43-290e-4176-b1d2-92df7ba2a917" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>emission_without_margins</th>
      <th>margin_emissions</th>
      <th>emission_with_margins</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1.8288e+04</td>
      <td>1.8288e+04</td>
      <td>1.8288e+04</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.0224e-02</td>
      <td>8.1677e-04</td>
      <td>1.1041e-02</td>
    </tr>
    <tr>
      <th>std</th>
      <td>6.3765e-02</td>
      <td>5.7729e-03</td>
      <td>6.6692e-02</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.9700e-11</td>
      <td>0.0000e+00</td>
      <td>1.9700e-11</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.3300e-09</td>
      <td>0.0000e+00</td>
      <td>1.5800e-09</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.4200e-08</td>
      <td>0.0000e+00</td>
      <td>1.6500e-08</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>3.3875e-07</td>
      <td>1.6100e-09</td>
      <td>3.5000e-07</td>
    </tr>
    <tr>
      <th>max</th>
      <td>3.7900e+00</td>
      <td>1.0900e-01</td>
      <td>3.8600e+00</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-5819cb43-290e-4176-b1d2-92df7ba2a917')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-5819cb43-290e-4176-b1d2-92df7ba2a917 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-5819cb43-290e-4176-b1d2-92df7ba2a917');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>

</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:301}"
id="n1MLdQ-8T9Cq" data-outputId="55f3cab1-e342-46fc-f454-fb9391f4cbe3">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df_co2e[[</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;emission_without_margins&quot;</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;margin_emissions&quot;</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;emission_with_margins&quot;</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>]].describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="17">

  <div id="df-35b8818e-866a-4450-9dbe-82af695ec6d5" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>emission_without_margins</th>
      <th>margin_emissions</th>
      <th>emission_with_margins</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1.0160e+03</td>
      <td>1.0160e+03</td>
      <td>1.0160e+03</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.6499e-01</td>
      <td>1.6945e-02</td>
      <td>2.8190e-01</td>
    </tr>
    <tr>
      <th>std</th>
      <td>3.1477e-01</td>
      <td>2.3367e-02</td>
      <td>3.2142e-01</td>
    </tr>
    <tr>
      <th>min</th>
      <td>2.6000e-02</td>
      <td>0.0000e+00</td>
      <td>2.9000e-02</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.0300e-01</td>
      <td>0.0000e+00</td>
      <td>1.0800e-01</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.5900e-01</td>
      <td>0.0000e+00</td>
      <td>1.7300e-01</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>3.0225e-01</td>
      <td>3.0250e-02</td>
      <td>3.2925e-01</td>
    </tr>
    <tr>
      <th>max</th>
      <td>3.8460e+00</td>
      <td>1.2500e-01</td>
      <td>3.9240e+00</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-35b8818e-866a-4450-9dbe-82af695ec6d5')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-35b8818e-866a-4450-9dbe-82af695ec6d5 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-35b8818e-866a-4450-9dbe-82af695ec6d5');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>

</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:487}"
id="Rk7enRbPT89t" data-outputId="432bad28-8b8b-4b16-f143-9af97766ed79">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">5</span>))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>plt.hist(df_ghg[<span class="st">&quot;emission_with_margins&quot;</span>], bins<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>plt.yscale(<span class="st">&quot;log&quot;</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Emission Factor (with margins)&quot;</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Frequency (log scale)&quot;</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;GHG Supply Chain Emission Factor Distribution&quot;</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b15773ef4fd4837b98e3c87086a90fb/e2de6029037260d874731b890c9c4a055e28724a.png" /></p>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:487}"
id="XG-iy-LOT82R" data-outputId="a23cb8ad-4080-43c9-cdb2-9c9e68cefc1a">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">5</span>))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>plt.hist(df_co2e[<span class="st">&quot;emission_with_margins&quot;</span>], bins<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>plt.yscale(<span class="st">&quot;log&quot;</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Emission Factor (with margins)&quot;</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Frequency (log scale)&quot;</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;CO2e Supply Chain Emission Factor Distribution&quot;</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b15773ef4fd4837b98e3c87086a90fb/8df25adb91bbe479dd50d06b4fb1be98a7fa01d1.png" /></p>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:614}"
id="2osb7VAwz8K2" data-outputId="22f6702c-6349-45fd-8441-3c9899767c34">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>ghg_summary <span class="op">=</span> (</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    df_ghg.groupby(<span class="st">&quot;ghg_type&quot;</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>          .agg(</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>              mean_emission<span class="op">=</span>(<span class="st">&quot;emission_with_margins&quot;</span>, <span class="st">&quot;mean&quot;</span>),</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>              median_emission<span class="op">=</span>(<span class="st">&quot;emission_with_margins&quot;</span>, <span class="st">&quot;median&quot;</span>),</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>              max_emission<span class="op">=</span>(<span class="st">&quot;emission_with_margins&quot;</span>, <span class="st">&quot;max&quot;</span>),</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>              count<span class="op">=</span>(<span class="st">&quot;ghg_type&quot;</span>, <span class="st">&quot;count&quot;</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>          .reset_index()</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>ghg_summary</span></code></pre></div>
<div class="output execute_result" data-execution_count="20">

  <div id="df-ac1f18ec-55d7-448d-9f98-2804b2a2aad8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ghg_type</th>
      <th>mean_emission</th>
      <th>median_emission</th>
      <th>max_emission</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Carbon dioxide</td>
      <td>1.9493e-01</td>
      <td>1.3700e-01</td>
      <td>3.8600e+00</td>
      <td>1016</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Carbon tetrafluoride</td>
      <td>7.0213e-08</td>
      <td>1.7500e-08</td>
      <td>1.0400e-05</td>
      <td>1016</td>
    </tr>
    <tr>
      <th>2</th>
      <td>HFC-125</td>
      <td>2.5484e-07</td>
      <td>1.5150e-07</td>
      <td>5.6300e-06</td>
      <td>1016</td>
    </tr>
    <tr>
      <th>3</th>
      <td>HFC-134a</td>
      <td>4.1750e-07</td>
      <td>2.4900e-07</td>
      <td>9.2100e-06</td>
      <td>1016</td>
    </tr>
    <tr>
      <th>4</th>
      <td>HFC-143a</td>
      <td>7.1395e-08</td>
      <td>4.2400e-08</td>
      <td>1.5400e-06</td>
      <td>1016</td>
    </tr>
    <tr>
      <th>5</th>
      <td>HFC-23</td>
      <td>2.0566e-08</td>
      <td>6.2400e-09</td>
      <td>7.0300e-06</td>
      <td>1016</td>
    </tr>
    <tr>
      <th>6</th>
      <td>HFC-236fa</td>
      <td>8.1246e-10</td>
      <td>4.8550e-10</td>
      <td>1.8500e-08</td>
      <td>1016</td>
    </tr>
    <tr>
      <th>7</th>
      <td>HFC-32</td>
      <td>1.6921e-07</td>
      <td>1.0100e-07</td>
      <td>3.8500e-06</td>
      <td>1016</td>
    </tr>
    <tr>
      <th>8</th>
      <td>HFCs and PFCs, unspecified</td>
      <td>2.0011e-03</td>
      <td>1.1900e-03</td>
      <td>4.4200e-02</td>
      <td>1016</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Hexafluoroethane</td>
      <td>8.9227e-09</td>
      <td>2.6200e-09</td>
      <td>1.0400e-06</td>
      <td>1016</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Methane</td>
      <td>1.6697e-03</td>
      <td>4.7800e-04</td>
      <td>5.8200e-02</td>
      <td>1016</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Nitrogen trifluoride</td>
      <td>3.9140e-09</td>
      <td>1.5150e-09</td>
      <td>4.1600e-07</td>
      <td>1016</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Nitrous oxide</td>
      <td>1.3221e-04</td>
      <td>1.9750e-05</td>
      <td>3.8500e-03</td>
      <td>1016</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Perfluorobutane</td>
      <td>3.3963e-09</td>
      <td>7.8100e-10</td>
      <td>6.8700e-07</td>
      <td>1016</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Perfluorocyclobutane</td>
      <td>9.5284e-09</td>
      <td>2.6200e-09</td>
      <td>1.8200e-06</td>
      <td>1016</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Perfluorohexane</td>
      <td>2.6259e-09</td>
      <td>6.0400e-10</td>
      <td>5.3100e-07</td>
      <td>1016</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Perfluoropropane</td>
      <td>5.8121e-10</td>
      <td>2.6200e-10</td>
      <td>1.2500e-07</td>
      <td>1016</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Sulfur hexafluoride</td>
      <td>1.6083e-08</td>
      <td>9.7300e-09</td>
      <td>3.5000e-07</td>
      <td>1016</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ac1f18ec-55d7-448d-9f98-2804b2a2aad8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ac1f18ec-55d7-448d-9f98-2804b2a2aad8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ac1f18ec-55d7-448d-9f98-2804b2a2aad8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


  <div id="id_c9c07ff1-05e4-4a09-a1d9-6f6f944c2d59">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('ghg_summary')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_c9c07ff1-05e4-4a09-a1d9-6f6f944c2d59 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('ghg_summary');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" id="mL-EqOz0z8HH">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>ghg_naics <span class="op">=</span> (</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    df_ghg.groupby([<span class="st">&quot;naics_code&quot;</span>, <span class="st">&quot;naics_title&quot;</span>])</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>          .agg(avg_emission<span class="op">=</span>(<span class="st">&quot;emission_with_margins&quot;</span>, <span class="st">&quot;mean&quot;</span>))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>          .reset_index()</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>co2_naics <span class="op">=</span> (</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    df_co2e.groupby([<span class="st">&quot;naics_code&quot;</span>, <span class="st">&quot;naics_title&quot;</span>])</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>          .agg(avg_emission<span class="op">=</span>(<span class="st">&quot;emission_with_margins&quot;</span>, <span class="st">&quot;mean&quot;</span>))</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>          .reset_index()</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:363}"
id="ox-Jofloz8DZ" data-outputId="c99908ac-e7d0-47e0-e4f2-55543becf22f">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>ghg_naics.sort_values(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    by<span class="op">=</span><span class="st">&quot;avg_emission&quot;</span>, ascending<span class="op">=</span><span class="va">False</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>).head(<span class="dv">10</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="22">

  <div id="df-1ebfe69e-50f9-4753-b8cd-15c50a01af5a" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>naics_code</th>
      <th>naics_title</th>
      <th>avg_emission</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>289703</th>
      <td>327310</td>
      <td>Cement Manufacturing</td>
      <td>2.1463e-01</td>
    </tr>
    <tr>
      <th>296036</th>
      <td>327420</td>
      <td>Gypsum Product Manufacturing</td>
      <td>8.6269e-02</td>
    </tr>
    <tr>
      <th>295109</th>
      <td>327410</td>
      <td>Lime Manufacturing</td>
      <td>8.6269e-02</td>
    </tr>
    <tr>
      <th>666542</th>
      <td>486990</td>
      <td>All Other Pipeline Transportation</td>
      <td>6.0008e-02</td>
    </tr>
    <tr>
      <th>666225</th>
      <td>486910</td>
      <td>Pipeline Transportation of Refined Petroleum P...</td>
      <td>6.0008e-02</td>
    </tr>
    <tr>
      <th>665208</th>
      <td>486210</td>
      <td>Pipeline Transportation of Natural Gas</td>
      <td>6.0008e-02</td>
    </tr>
    <tr>
      <th>664191</th>
      <td>486110</td>
      <td>Pipeline Transportation of Crude Oil</td>
      <td>6.0008e-02</td>
    </tr>
    <tr>
      <th>239176</th>
      <td>325120</td>
      <td>Industrial Gas Manufacturing</td>
      <td>5.9026e-02</td>
    </tr>
    <tr>
      <th>233759</th>
      <td>324121</td>
      <td>Asphalt Paving Mixture and Block Manufacturing</td>
      <td>5.7442e-02</td>
    </tr>
    <tr>
      <th>242094</th>
      <td>325193</td>
      <td>Ethyl Alcohol Manufacturing</td>
      <td>5.3848e-02</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1ebfe69e-50f9-4753-b8cd-15c50a01af5a')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1ebfe69e-50f9-4753-b8cd-15c50a01af5a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1ebfe69e-50f9-4753-b8cd-15c50a01af5a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>

</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:363}"
id="PpMFAdcqz7_r" data-outputId="281c501b-fc6a-4033-cca3-958ec0c036ec">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>co2_naics.sort_values(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    by<span class="op">=</span><span class="st">&quot;avg_emission&quot;</span>, ascending<span class="op">=</span><span class="va">False</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>).head(<span class="dv">10</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="23">

  <div id="df-667b557c-aaa9-4b99-a6e5-420419b07bce" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>naics_code</th>
      <th>naics_title</th>
      <th>avg_emission</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>289703</th>
      <td>327310</td>
      <td>Cement Manufacturing</td>
      <td>3.9240e+00</td>
    </tr>
    <tr>
      <th>30579</th>
      <td>112111</td>
      <td>Beef Cattle Ranching and Farming</td>
      <td>2.8930e+00</td>
    </tr>
    <tr>
      <th>33795</th>
      <td>112130</td>
      <td>Dual-Purpose Cattle Ranching and Farming</td>
      <td>2.8930e+00</td>
    </tr>
    <tr>
      <th>31638</th>
      <td>112112</td>
      <td>Cattle Feedlots</td>
      <td>2.8930e+00</td>
    </tr>
    <tr>
      <th>32746</th>
      <td>112120</td>
      <td>Dairy Cattle and Milk Production</td>
      <td>1.7240e+00</td>
    </tr>
    <tr>
      <th>295109</th>
      <td>327410</td>
      <td>Lime Manufacturing</td>
      <td>1.6230e+00</td>
    </tr>
    <tr>
      <th>296036</th>
      <td>327420</td>
      <td>Gypsum Product Manufacturing</td>
      <td>1.6230e+00</td>
    </tr>
    <tr>
      <th>664191</th>
      <td>486110</td>
      <td>Pipeline Transportation of Crude Oil</td>
      <td>1.6190e+00</td>
    </tr>
    <tr>
      <th>666542</th>
      <td>486990</td>
      <td>All Other Pipeline Transportation</td>
      <td>1.6190e+00</td>
    </tr>
    <tr>
      <th>666225</th>
      <td>486910</td>
      <td>Pipeline Transportation of Refined Petroleum P...</td>
      <td>1.6190e+00</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-667b557c-aaa9-4b99-a6e5-420419b07bce')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-667b557c-aaa9-4b99-a6e5-420419b07bce button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-667b557c-aaa9-4b99-a6e5-420419b07bce');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>

</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="aZWI8xMxz78G" data-outputId="d79fa1de-7971-4c93-a9d4-7571d5117390">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df_ghg[<span class="st">&quot;margin_share&quot;</span>] <span class="op">=</span> (</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    df_ghg[<span class="st">&quot;margin_emissions&quot;</span>] <span class="op">/</span> df_ghg[<span class="st">&quot;emission_with_margins&quot;</span>]</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>df_co2e[<span class="st">&quot;margin_share&quot;</span>] <span class="op">=</span> (</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    df_co2e[<span class="st">&quot;margin_emissions&quot;</span>] <span class="op">/</span> df_co2e[<span class="st">&quot;emission_with_margins&quot;</span>]</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>df_ghg[<span class="st">&quot;margin_share&quot;</span>].describe(), df_co2e[<span class="st">&quot;margin_share&quot;</span>].describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="24">
<pre><code>(count   1.8288e+04
 mean    1.2289e-01
 std     1.8570e-01
 min     0.0000e+00
 25%     0.0000e+00
 50%     0.0000e+00
 75%     2.1335e-01
 max     8.4960e-01
 Name: margin_share, dtype: float64,
 count   1.0160e+03
 mean    6.8911e-02
 std     1.1489e-01
 min     0.0000e+00
 25%     0.0000e+00
 50%     0.0000e+00
 75%     1.0050e-01
 max     5.6667e-01
 Name: margin_share, dtype: float64)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="38"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:74}"
id="KNJVY_FNqFl7" data-outputId="d75b1e62-e86f-48ca-e093-0797fb35bc68">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> files</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>uploaded <span class="op">=</span> files.upload()</span></code></pre></div>
<div class="output display_data">

     <input type="file" id="files-93e7150c-1e4f-456f-adf0-d433d77c9fc5" name="files[]" multiple disabled
        style="border:none" />
     <output id="result-93e7150c-1e4f-456f-adf0-d433d77c9fc5">
      Upload widget is only available when the cell has been executed in the
      current browser session. Please rerun this cell to enable.
      </output>
      <script>// Copyright 2017 Google LLC
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

/**
 * @fileoverview Helpers for google.colab Python module.
 */
(function(scope) {
function span(text, styleAttributes = {}) {
  const element = document.createElement('span');
  element.textContent = text;
  for (const key of Object.keys(styleAttributes)) {
    element.style[key] = styleAttributes[key];
  }
  return element;
}

// Max number of bytes which will be uploaded at a time.
const MAX_PAYLOAD_SIZE = 100 * 1024;

function _uploadFiles(inputId, outputId) {
  const steps = uploadFilesStep(inputId, outputId);
  const outputElement = document.getElementById(outputId);
  // Cache steps on the outputElement to make it available for the next call
  // to uploadFilesContinue from Python.
  outputElement.steps = steps;

  return _uploadFilesContinue(outputId);
}

// This is roughly an async generator (not supported in the browser yet),
// where there are multiple asynchronous steps and the Python side is going
// to poll for completion of each step.
// This uses a Promise to block the python side on completion of each step,
// then passes the result of the previous step as the input to the next step.
function _uploadFilesContinue(outputId) {
  const outputElement = document.getElementById(outputId);
  const steps = outputElement.steps;

  const next = steps.next(outputElement.lastPromiseValue);
  return Promise.resolve(next.value.promise).then((value) => {
    // Cache the last promise value to make it available to the next
    // step of the generator.
    outputElement.lastPromiseValue = value;
    return next.value.response;
  });
}

/**
 * Generator function which is called between each async step of the upload
 * process.
 * @param {string} inputId Element ID of the input file picker element.
 * @param {string} outputId Element ID of the output display.
 * @return {!Iterable<!Object>} Iterable of next steps.
 */
function* uploadFilesStep(inputId, outputId) {
  const inputElement = document.getElementById(inputId);
  inputElement.disabled = false;

  const outputElement = document.getElementById(outputId);
  outputElement.innerHTML = '';

  const pickedPromise = new Promise((resolve) => {
    inputElement.addEventListener('change', (e) => {
      resolve(e.target.files);
    });
  });

  const cancel = document.createElement('button');
  inputElement.parentElement.appendChild(cancel);
  cancel.textContent = 'Cancel upload';
  const cancelPromise = new Promise((resolve) => {
    cancel.onclick = () => {
      resolve(null);
    };
  });

  // Wait for the user to pick the files.
  const files = yield {
    promise: Promise.race([pickedPromise, cancelPromise]),
    response: {
      action: 'starting',
    }
  };

  cancel.remove();

  // Disable the input element since further picks are not allowed.
  inputElement.disabled = true;

  if (!files) {
    return {
      response: {
        action: 'complete',
      }
    };
  }

  for (const file of files) {
    const li = document.createElement('li');
    li.append(span(file.name, {fontWeight: 'bold'}));
    li.append(span(
        `(${file.type || 'n/a'}) - ${file.size} bytes, ` +
        `last modified: ${
            file.lastModifiedDate ? file.lastModifiedDate.toLocaleDateString() :
                                    'n/a'} - `));
    const percent = span('0% done');
    li.appendChild(percent);

    outputElement.appendChild(li);

    const fileDataPromise = new Promise((resolve) => {
      const reader = new FileReader();
      reader.onload = (e) => {
        resolve(e.target.result);
      };
      reader.readAsArrayBuffer(file);
    });
    // Wait for the data to be ready.
    let fileData = yield {
      promise: fileDataPromise,
      response: {
        action: 'continue',
      }
    };

    // Use a chunked sending to avoid message size limits. See b/62115660.
    let position = 0;
    do {
      const length = Math.min(fileData.byteLength - position, MAX_PAYLOAD_SIZE);
      const chunk = new Uint8Array(fileData, position, length);
      position += length;

      const base64 = btoa(String.fromCharCode.apply(null, chunk));
      yield {
        response: {
          action: 'append',
          file: file.name,
          data: base64,
        },
      };

      let percentDone = fileData.byteLength === 0 ?
          100 :
          Math.round((position / fileData.byteLength) * 100);
      percent.textContent = `${percentDone}% done`;

    } while (position < fileData.byteLength);
  }

  // All done.
  yield {
    response: {
      action: 'complete',
    }
  };
}

scope.google = scope.google || {};
scope.google.colab = scope.google.colab || {};
scope.google.colab._files = {
  _uploadFiles,
  _uploadFilesContinue,
};
})(self);
</script> 
</div>
<div class="output stream stdout">
<pre><code>Saving ghg-emission-factors-hub-2022.xlsx to ghg-emission-factors-hub-2022 (4).xlsx
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="40"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="wB0Qh5uZ7BX1" data-outputId="79c783a6-ecc4-4df2-e69d-a8e6b766909d">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>file_path <span class="op">=</span> <span class="bu">list</span>(uploaded.keys())[<span class="dv">0</span>]</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Uploaded file:&quot;</span>, file_path)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Uploaded file: ghg-emission-factors-hub-2022 (4).xlsx
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="56"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="BFJV4yz59NmP" data-outputId="b2d358e8-ca70-4747-c860-453135429d80">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> load_workbook</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the Excel file</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co">#file_path = &#39;ghg-emission-factors-hub-2025.xlsx&#39;</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>wb <span class="op">=</span> load_workbook(file_path, data_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>sheet <span class="op">=</span> wb[<span class="st">&#39;Emission Factors Hub&#39;</span>]</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert sheet to pandas DataFrame</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_excel(file_path, sheet_name<span class="op">=</span><span class="st">&#39;Emission Factors Hub&#39;</span>, header<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;GHG EMISSION FACTORS HUB 2025 - EXPLORATORY DATA ANALYSIS&quot;</span>)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. BASIC FILE INFORMATION</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">1. FILE METADATA AND STRUCTURE&quot;</span>)</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;-&quot;</span><span class="op">*</span><span class="dv">40</span>)</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Find document title and last modified date</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>title_row <span class="op">=</span> <span class="va">None</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>last_modified <span class="op">=</span> <span class="va">None</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, row <span class="kw">in</span> df.iterrows():</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> cell <span class="kw">in</span> row:</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(cell, <span class="bu">str</span>):</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&quot;Emission Factors for Greenhouse Gas Inventories&quot;</span> <span class="kw">in</span> cell:</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>                title_row <span class="op">=</span> idx</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&quot;Last Modified:&quot;</span> <span class="kw">in</span> cell:</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>                last_modified <span class="op">=</span> cell.split(<span class="st">&quot;Last Modified:&quot;</span>)[<span class="dv">1</span>].strip()</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Document Title: Emission Factors for Greenhouse Gas Inventories&quot;</span>)</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Last Modified: </span><span class="sc">{</span>last_modified<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Total Rows: </span><span class="sc">{</span>df<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Total Columns: </span><span class="sc">{</span>df<span class="sc">.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. IDENTIFY ALL TABLES IN THE DOCUMENT</span></span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">2. TABLE IDENTIFICATION&quot;</span>)</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;-&quot;</span><span class="op">*</span><span class="dv">40</span>)</span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>tables <span class="op">=</span> {}</span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>current_table <span class="op">=</span> <span class="va">None</span></span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>table_start <span class="op">=</span> <span class="va">None</span></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, row <span class="kw">in</span> df.iterrows():</span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> cell <span class="kw">in</span> row:</span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(cell, <span class="bu">str</span>) <span class="kw">and</span> cell.startswith(<span class="st">&quot;Table&quot;</span>):</span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>            current_table <span class="op">=</span> cell.strip()</span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>            table_start <span class="op">=</span> idx</span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>            tables[current_table] <span class="op">=</span> {<span class="st">&quot;start&quot;</span>: idx, <span class="st">&quot;end&quot;</span>: <span class="va">None</span>, <span class="st">&quot;name&quot;</span>: cell}</span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_table <span class="kw">and</span> idx <span class="op">&gt;</span> table_start <span class="kw">and</span> row.isnull().<span class="bu">all</span>():</span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_table <span class="kw">in</span> tables:</span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>            tables[current_table][<span class="st">&quot;end&quot;</span>] <span class="op">=</span> idx</span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Found </span><span class="sc">{</span><span class="bu">len</span>(tables)<span class="sc">}</span><span class="ss"> tables in the document:&quot;</span>)</span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> table_name, info <span class="kw">in</span> tables.items():</span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;  - </span><span class="sc">{</span>table_name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. GLOBAL WARMING POTENTIALS (GWP) ANALYSIS</span></span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">3. GLOBAL WARMING POTENTIAL (GWP) ANALYSIS&quot;</span>)</span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;-&quot;</span><span class="op">*</span><span class="dv">40</span>)</span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract GWP values (from beginning of sheet)</span></span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a>gwp_data <span class="op">=</span> []</span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, row <span class="kw">in</span> df.iterrows():</span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> cell <span class="kw">in</span> row:</span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(cell, <span class="bu">str</span>) <span class="kw">and</span> (<span class="st">&quot;GWP&quot;</span> <span class="kw">in</span> cell <span class="kw">or</span> <span class="st">&quot;CH4&quot;</span> <span class="kw">in</span> cell <span class="kw">or</span> <span class="st">&quot;N2O&quot;</span> <span class="kw">in</span> cell):</span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> idx <span class="op">&lt;</span> <span class="dv">20</span>:  <span class="co"># GWP section is near the top</span></span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true" tabindex="-1"></a>                gwp_data.append((idx, cell))</span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-74"><a href="#cb36-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Display key GWP values</span></span>
<span id="cb36-75"><a href="#cb36-75" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Key Global Warming Potentials (100-year GWP):&quot;</span>)</span>
<span id="cb36-76"><a href="#cb36-76" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;  - CO2: 1&quot;</span>)</span>
<span id="cb36-77"><a href="#cb36-77" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;  - CH4: 28&quot;</span>)</span>
<span id="cb36-78"><a href="#cb36-78" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;  - N2O: 265&quot;</span>)</span>
<span id="cb36-79"><a href="#cb36-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-80"><a href="#cb36-80" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. STATIONARY COMBUSTION ANALYSIS (Table 1)</span></span>
<span id="cb36-81"><a href="#cb36-81" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">4. STATIONARY COMBUSTION - KEY INSIGHTS&quot;</span>)</span>
<span id="cb36-82"><a href="#cb36-82" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;-&quot;</span><span class="op">*</span><span class="dv">40</span>)</span>
<span id="cb36-83"><a href="#cb36-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-84"><a href="#cb36-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract fuel categories from Table 1</span></span>
<span id="cb36-85"><a href="#cb36-85" aria-hidden="true" tabindex="-1"></a>fuel_categories <span class="op">=</span> {</span>
<span id="cb36-86"><a href="#cb36-86" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Coal and Coke&quot;</span>: [],</span>
<span id="cb36-87"><a href="#cb36-87" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Other Fuels - Solid&quot;</span>: [],</span>
<span id="cb36-88"><a href="#cb36-88" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Biomass Fuels - Solid&quot;</span>: [],</span>
<span id="cb36-89"><a href="#cb36-89" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Natural Gas&quot;</span>: [],</span>
<span id="cb36-90"><a href="#cb36-90" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Other Fuels - Gaseous&quot;</span>: [],</span>
<span id="cb36-91"><a href="#cb36-91" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Biomass Fuels - Gaseous&quot;</span>: [],</span>
<span id="cb36-92"><a href="#cb36-92" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Petroleum Products&quot;</span>: [],</span>
<span id="cb36-93"><a href="#cb36-93" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Biomass Fuels - Liquid&quot;</span>: [],</span>
<span id="cb36-94"><a href="#cb36-94" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Biomass Fuels - Kraft Pulping&quot;</span>: []</span>
<span id="cb36-95"><a href="#cb36-95" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-96"><a href="#cb36-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-97"><a href="#cb36-97" aria-hidden="true" tabindex="-1"></a><span class="co"># Find Table 1 data range</span></span>
<span id="cb36-98"><a href="#cb36-98" aria-hidden="true" tabindex="-1"></a>table1_start <span class="op">=</span> tables.get(<span class="st">&quot;Table 1&quot;</span>, {}).get(<span class="st">&quot;start&quot;</span>)</span>
<span id="cb36-99"><a href="#cb36-99" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> table1_start:</span>
<span id="cb36-100"><a href="#cb36-100" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract sample of fuel types and their CO2 factors</span></span>
<span id="cb36-101"><a href="#cb36-101" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Sample Fuel Types and CO2 Emission Factors:&quot;</span>)</span>
<span id="cb36-102"><a href="#cb36-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-103"><a href="#cb36-103" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(table1_start, <span class="bu">min</span>(table1_start <span class="op">+</span> <span class="dv">50</span>, <span class="bu">len</span>(df))):</span>
<span id="cb36-104"><a href="#cb36-104" aria-hidden="true" tabindex="-1"></a>        fuel_type <span class="op">=</span> df.iloc[idx, <span class="dv">2</span>] <span class="cf">if</span> <span class="bu">len</span>(df.columns) <span class="op">&gt;</span> <span class="dv">2</span> <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb36-105"><a href="#cb36-105" aria-hidden="true" tabindex="-1"></a>        co2_factor <span class="op">=</span> df.iloc[idx, <span class="dv">4</span>] <span class="cf">if</span> <span class="bu">len</span>(df.columns) <span class="op">&gt;</span> <span class="dv">4</span> <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb36-106"><a href="#cb36-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-107"><a href="#cb36-107" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(fuel_type, <span class="bu">str</span>) <span class="kw">and</span> fuel_type.strip() <span class="kw">and</span> <span class="kw">not</span> fuel_type.startswith(<span class="st">&quot;Table&quot;</span>):</span>
<span id="cb36-108"><a href="#cb36-108" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(co2_factor, (<span class="bu">int</span>, <span class="bu">float</span>)):</span>
<span id="cb36-109"><a href="#cb36-109" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;  - </span><span class="sc">{</span>fuel_type<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>co2_factor<span class="sc">}</span><span class="ss"> kg CO2/mmBtu&quot;</span>)</span>
<span id="cb36-110"><a href="#cb36-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-111"><a href="#cb36-111" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. MOBILE COMBUSTION ANALYSIS</span></span>
<span id="cb36-112"><a href="#cb36-112" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">5. MOBILE COMBUSTION - KEY INSIGHTS&quot;</span>)</span>
<span id="cb36-113"><a href="#cb36-113" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;-&quot;</span><span class="op">*</span><span class="dv">40</span>)</span>
<span id="cb36-114"><a href="#cb36-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-115"><a href="#cb36-115" aria-hidden="true" tabindex="-1"></a>mobile_tables <span class="op">=</span> [<span class="st">&quot;Table 2&quot;</span>, <span class="st">&quot;Table 3&quot;</span>, <span class="st">&quot;Table 4&quot;</span>, <span class="st">&quot;Table 5&quot;</span>]</span>
<span id="cb36-116"><a href="#cb36-116" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Mobile combustion covered in </span><span class="sc">{</span><span class="bu">len</span>(mobile_tables)<span class="sc">}</span><span class="ss"> tables:&quot;</span>)</span>
<span id="cb36-117"><a href="#cb36-117" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> table <span class="kw">in</span> mobile_tables:</span>
<span id="cb36-118"><a href="#cb36-118" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;  - </span><span class="sc">{</span>table<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb36-119"><a href="#cb36-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-120"><a href="#cb36-120" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. ELECTRICITY GRID ANALYSIS (Table 6)</span></span>
<span id="cb36-121"><a href="#cb36-121" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">6. ELECTRICITY GRID EMISSION FACTORS&quot;</span>)</span>
<span id="cb36-122"><a href="#cb36-122" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;-&quot;</span><span class="op">*</span><span class="dv">40</span>)</span>
<span id="cb36-123"><a href="#cb36-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-124"><a href="#cb36-124" aria-hidden="true" tabindex="-1"></a><span class="co"># Count eGRID subregions</span></span>
<span id="cb36-125"><a href="#cb36-125" aria-hidden="true" tabindex="-1"></a>egrid_regions <span class="op">=</span> []</span>
<span id="cb36-126"><a href="#cb36-126" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, row <span class="kw">in</span> df.iterrows():</span>
<span id="cb36-127"><a href="#cb36-127" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> cell <span class="kw">in</span> row:</span>
<span id="cb36-128"><a href="#cb36-128" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(cell, <span class="bu">str</span>) <span class="kw">and</span> <span class="st">&quot;eGRID Subregion&quot;</span> <span class="kw">in</span> cell:</span>
<span id="cb36-129"><a href="#cb36-129" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Look for region names in subsequent rows</span></span>
<span id="cb36-130"><a href="#cb36-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(idx<span class="op">+</span><span class="dv">1</span>, <span class="bu">min</span>(idx<span class="op">+</span><span class="dv">50</span>, <span class="bu">len</span>(df))):</span>
<span id="cb36-131"><a href="#cb36-131" aria-hidden="true" tabindex="-1"></a>                region_cell <span class="op">=</span> df.iloc[i, <span class="dv">2</span>] <span class="cf">if</span> <span class="bu">len</span>(df.columns) <span class="op">&gt;</span> <span class="dv">2</span> <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb36-132"><a href="#cb36-132" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">isinstance</span>(region_cell, <span class="bu">str</span>) <span class="kw">and</span> region_cell.strip():</span>
<span id="cb36-133"><a href="#cb36-133" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> region_cell <span class="kw">not</span> <span class="kw">in</span> egrid_regions <span class="kw">and</span> <span class="bu">len</span>(region_cell) <span class="op">&lt;=</span> <span class="dv">10</span>:</span>
<span id="cb36-134"><a href="#cb36-134" aria-hidden="true" tabindex="-1"></a>                        egrid_regions.append(region_cell)</span>
<span id="cb36-135"><a href="#cb36-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-136"><a href="#cb36-136" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Number of eGRID Subregions: </span><span class="sc">{</span><span class="bu">len</span>(egrid_regions)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb36-137"><a href="#cb36-137" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;US Average CO2 Factor: 771.523 lb CO2/MWh&quot;</span>)</span>
<span id="cb36-138"><a href="#cb36-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-139"><a href="#cb36-139" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. SCOPE 3 EMISSION FACTORS ANALYSIS</span></span>
<span id="cb36-140"><a href="#cb36-140" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">7. SCOPE 3 EMISSION FACTORS&quot;</span>)</span>
<span id="cb36-141"><a href="#cb36-141" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;-&quot;</span><span class="op">*</span><span class="dv">40</span>)</span>
<span id="cb36-142"><a href="#cb36-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-143"><a href="#cb36-143" aria-hidden="true" tabindex="-1"></a>scope3_tables <span class="op">=</span> [<span class="st">&quot;Table 8&quot;</span>, <span class="st">&quot;Table 9&quot;</span>, <span class="st">&quot;Table 10&quot;</span>]</span>
<span id="cb36-144"><a href="#cb36-144" aria-hidden="true" tabindex="-1"></a>scope3_categories <span class="op">=</span> {</span>
<span id="cb36-145"><a href="#cb36-145" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Table 8&quot;</span>: <span class="st">&quot;Category 4 &amp; 9: Transportation and Distribution&quot;</span>,</span>
<span id="cb36-146"><a href="#cb36-146" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Table 9&quot;</span>: <span class="st">&quot;Category 5 &amp; 12: Waste Management&quot;</span>,</span>
<span id="cb36-147"><a href="#cb36-147" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Table 10&quot;</span>: <span class="st">&quot;Category 6 &amp; 7: Business Travel &amp; Commuting&quot;</span></span>
<span id="cb36-148"><a href="#cb36-148" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-149"><a href="#cb36-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-150"><a href="#cb36-150" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Scope 3 Emission Factors Tables:&quot;</span>)</span>
<span id="cb36-151"><a href="#cb36-151" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> table, category <span class="kw">in</span> scope3_categories.items():</span>
<span id="cb36-152"><a href="#cb36-152" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;  - </span><span class="sc">{</span>table<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>category<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb36-153"><a href="#cb36-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-154"><a href="#cb36-154" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. DATA QUALITY AND COMPLETENESS ANALYSIS</span></span>
<span id="cb36-155"><a href="#cb36-155" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">8. DATA QUALITY ASSESSMENT&quot;</span>)</span>
<span id="cb36-156"><a href="#cb36-156" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;-&quot;</span><span class="op">*</span><span class="dv">40</span>)</span>
<span id="cb36-157"><a href="#cb36-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-158"><a href="#cb36-158" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for empty cells in the first 100 rows</span></span>
<span id="cb36-159"><a href="#cb36-159" aria-hidden="true" tabindex="-1"></a>empty_cells_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb36-160"><a href="#cb36-160" aria-hidden="true" tabindex="-1"></a>total_cells_checked <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb36-161"><a href="#cb36-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-162"><a href="#cb36-162" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">min</span>(<span class="dv">100</span>, <span class="bu">len</span>(df))):</span>
<span id="cb36-163"><a href="#cb36-163" aria-hidden="true" tabindex="-1"></a>    row_empty <span class="op">=</span> df.iloc[idx].isna().<span class="bu">sum</span>()</span>
<span id="cb36-164"><a href="#cb36-164" aria-hidden="true" tabindex="-1"></a>    empty_cells_count <span class="op">+=</span> row_empty</span>
<span id="cb36-165"><a href="#cb36-165" aria-hidden="true" tabindex="-1"></a>    total_cells_checked <span class="op">+=</span> <span class="bu">len</span>(df.columns)</span>
<span id="cb36-166"><a href="#cb36-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-167"><a href="#cb36-167" aria-hidden="true" tabindex="-1"></a>completeness_rate <span class="op">=</span> ((total_cells_checked <span class="op">-</span> empty_cells_count) <span class="op">/</span> total_cells_checked) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb36-168"><a href="#cb36-168" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Data completeness in first 100 rows: </span><span class="sc">{</span>completeness_rate<span class="sc">:.1f}</span><span class="ss">%&quot;</span>)</span>
<span id="cb36-169"><a href="#cb36-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-170"><a href="#cb36-170" aria-hidden="true" tabindex="-1"></a><span class="co"># 9. VISUALIZATION PREPARATION</span></span>
<span id="cb36-171"><a href="#cb36-171" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">9. DATA VISUALIZATION PREPARATION&quot;</span>)</span>
<span id="cb36-172"><a href="#cb36-172" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;-&quot;</span><span class="op">*</span><span class="dv">40</span>)</span>
<span id="cb36-173"><a href="#cb36-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-174"><a href="#cb36-174" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data for visualization</span></span>
<span id="cb36-175"><a href="#cb36-175" aria-hidden="true" tabindex="-1"></a>fuel_types_sample <span class="op">=</span> [</span>
<span id="cb36-176"><a href="#cb36-176" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Natural Gas&quot;</span>, <span class="st">&quot;Bituminous Coal&quot;</span>, <span class="st">&quot;Diesel Fuel&quot;</span>,</span>
<span id="cb36-177"><a href="#cb36-177" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Motor Gasoline&quot;</span>, <span class="st">&quot;Residual Fuel Oil&quot;</span>, <span class="st">&quot;Wood&quot;</span></span>
<span id="cb36-178"><a href="#cb36-178" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb36-179"><a href="#cb36-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-180"><a href="#cb36-180" aria-hidden="true" tabindex="-1"></a>co2_factors_sample <span class="op">=</span> [<span class="fl">53.06</span>, <span class="fl">93.28</span>, <span class="fl">73.96</span>, <span class="fl">70.22</span>, <span class="fl">75.10</span>, <span class="fl">93.80</span>]</span>
<span id="cb36-181"><a href="#cb36-181" aria-hidden="true" tabindex="-1"></a>units <span class="op">=</span> [<span class="st">&quot;kg CO2/mmBtu&quot;</span>] <span class="op">*</span> <span class="dv">6</span></span>
<span id="cb36-182"><a href="#cb36-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-183"><a href="#cb36-183" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a summary DataFrame</span></span>
<span id="cb36-184"><a href="#cb36-184" aria-hidden="true" tabindex="-1"></a>summary_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb36-185"><a href="#cb36-185" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Fuel Type&quot;</span>: fuel_types_sample,</span>
<span id="cb36-186"><a href="#cb36-186" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;CO2 Emission Factor&quot;</span>: co2_factors_sample,</span>
<span id="cb36-187"><a href="#cb36-187" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Unit&quot;</span>: units</span>
<span id="cb36-188"><a href="#cb36-188" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb36-189"><a href="#cb36-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-190"><a href="#cb36-190" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Sample Emission Factors for Visualization:&quot;</span>)</span>
<span id="cb36-191"><a href="#cb36-191" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(summary_df.to_string(index<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb36-192"><a href="#cb36-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-193"><a href="#cb36-193" aria-hidden="true" tabindex="-1"></a><span class="co"># 10. KEY FINDINGS SUMMARY</span></span>
<span id="cb36-194"><a href="#cb36-194" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span> <span class="op">+</span> <span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb36-195"><a href="#cb36-195" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;KEY FINDINGS SUMMARY&quot;</span>)</span>
<span id="cb36-196"><a href="#cb36-196" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb36-197"><a href="#cb36-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-198"><a href="#cb36-198" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">1. DOCUMENT STRUCTURE:&quot;</span>)</span>
<span id="cb36-199"><a href="#cb36-199" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;   - Contains </span><span class="sc">{</span><span class="bu">len</span>(tables)<span class="sc">}</span><span class="ss"> main data tables&quot;</span>)</span>
<span id="cb36-200"><a href="#cb36-200" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;   - Covers stationary, mobile, electricity, and Scope 3 emissions&quot;</span>)</span>
<span id="cb36-201"><a href="#cb36-201" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;   - Last updated: </span><span class="sc">{</span>last_modified<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb36-202"><a href="#cb36-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-203"><a href="#cb36-203" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">2. EMISSION FACTORS COVERAGE:&quot;</span>)</span>
<span id="cb36-204"><a href="#cb36-204" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;   - Stationary combustion: Multiple fuel types with heat content data&quot;</span>)</span>
<span id="cb36-205"><a href="#cb36-205" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;   - Mobile combustion: Vehicle-specific factors by model year&quot;</span>)</span>
<span id="cb36-206"><a href="#cb36-206" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;   - Electricity: Grid-specific factors for US subregions&quot;</span>)</span>
<span id="cb36-207"><a href="#cb36-207" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;   - Scope 3: Transportation, waste, and business travel&quot;</span>)</span>
<span id="cb36-208"><a href="#cb36-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-209"><a href="#cb36-209" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">3. GLOBAL WARMING POTENTIALS:&quot;</span>)</span>
<span id="cb36-210"><a href="#cb36-210" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;   - CH4: 28x more potent than CO2&quot;</span>)</span>
<span id="cb36-211"><a href="#cb36-211" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;   - N2O: 265x more potent than CO2&quot;</span>)</span>
<span id="cb36-212"><a href="#cb36-212" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;   - Based on IPCC AR5 (2013)&quot;</span>)</span>
<span id="cb36-213"><a href="#cb36-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-214"><a href="#cb36-214" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">4. DATA CHARACTERISTICS:&quot;</span>)</span>
<span id="cb36-215"><a href="#cb36-215" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;   - Complex hierarchical structure with merged cells&quot;</span>)</span>
<span id="cb36-216"><a href="#cb36-216" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;   - Mix of units (mmBtu, gallons, miles, MWh)&quot;</span>)</span>
<span id="cb36-217"><a href="#cb36-217" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;   - Both per-unit and per-distance emission factors&quot;</span>)</span>
<span id="cb36-218"><a href="#cb36-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-219"><a href="#cb36-219" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">5. RECOMMENDED NEXT STEPS:&quot;</span>)</span>
<span id="cb36-220"><a href="#cb36-220" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;   - Parse individual tables into separate DataFrames&quot;</span>)</span>
<span id="cb36-221"><a href="#cb36-221" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;   - Create lookup functions for specific fuel/vehicle types&quot;</span>)</span>
<span id="cb36-222"><a href="#cb36-222" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;   - Visualize emission factors by category&quot;</span>)</span>
<span id="cb36-223"><a href="#cb36-223" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;   - Calculate CO2e using provided GWP values&quot;</span>)</span>
<span id="cb36-224"><a href="#cb36-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-225"><a href="#cb36-225" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: Create visualizations</span></span>
<span id="cb36-226"><a href="#cb36-226" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_visualizations():</span>
<span id="cb36-227"><a href="#cb36-227" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Create sample visualizations of emission factors&quot;&quot;&quot;</span></span>
<span id="cb36-228"><a href="#cb36-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-229"><a href="#cb36-229" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set up the figure</span></span>
<span id="cb36-230"><a href="#cb36-230" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb36-231"><a href="#cb36-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-232"><a href="#cb36-232" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot 1: Sample CO2 emission factors</span></span>
<span id="cb36-233"><a href="#cb36-233" aria-hidden="true" tabindex="-1"></a>    colors <span class="op">=</span> plt.cm.Set3(np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="bu">len</span>(fuel_types_sample)))</span>
<span id="cb36-234"><a href="#cb36-234" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].barh(fuel_types_sample, co2_factors_sample, color<span class="op">=</span>colors)</span>
<span id="cb36-235"><a href="#cb36-235" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xlabel(<span class="st">&#39;CO2 Emission Factor (kg CO2/mmBtu)&#39;</span>)</span>
<span id="cb36-236"><a href="#cb36-236" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_title(<span class="st">&#39;Sample Stationary Combustion Emission Factors&#39;</span>)</span>
<span id="cb36-237"><a href="#cb36-237" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb36-238"><a href="#cb36-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-239"><a href="#cb36-239" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot 2: GWP comparison</span></span>
<span id="cb36-240"><a href="#cb36-240" aria-hidden="true" tabindex="-1"></a>    gases <span class="op">=</span> [<span class="st">&#39;CO2&#39;</span>, <span class="st">&#39;CH4&#39;</span>, <span class="st">&#39;N2O&#39;</span>]</span>
<span id="cb36-241"><a href="#cb36-241" aria-hidden="true" tabindex="-1"></a>    gwp_values <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">28</span>, <span class="dv">265</span>]</span>
<span id="cb36-242"><a href="#cb36-242" aria-hidden="true" tabindex="-1"></a>    colors_gwp <span class="op">=</span> [<span class="st">&#39;#2E86AB&#39;</span>, <span class="st">&#39;#A23B72&#39;</span>, <span class="st">&#39;#F18F01&#39;</span>]</span>
<span id="cb36-243"><a href="#cb36-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-244"><a href="#cb36-244" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].bar(gases, gwp_values, color<span class="op">=</span>colors_gwp)</span>
<span id="cb36-245"><a href="#cb36-245" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_yscale(<span class="st">&#39;log&#39;</span>)</span>
<span id="cb36-246"><a href="#cb36-246" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_ylabel(<span class="st">&#39;Global Warming Potential (100-year, log scale)&#39;</span>)</span>
<span id="cb36-247"><a href="#cb36-247" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_title(<span class="st">&#39;Global Warming Potentials (Relative to CO2)&#39;</span>)</span>
<span id="cb36-248"><a href="#cb36-248" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb36-249"><a href="#cb36-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-250"><a href="#cb36-250" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb36-251"><a href="#cb36-251" aria-hidden="true" tabindex="-1"></a>    plt.savefig(<span class="st">&#39;ghg_emission_factors_summary.png&#39;</span>, dpi<span class="op">=</span><span class="dv">150</span>, bbox_inches<span class="op">=</span><span class="st">&#39;tight&#39;</span>)</span>
<span id="cb36-252"><a href="#cb36-252" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb36-253"><a href="#cb36-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-254"><a href="#cb36-254" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fig</span>
<span id="cb36-255"><a href="#cb36-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-256"><a href="#cb36-256" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span> <span class="op">+</span> <span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb36-257"><a href="#cb36-257" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;EDA COMPLETE - Visualizations saved as &#39;ghg_emission_factors_summary.png&#39;&quot;</span>)</span>
<span id="cb36-258"><a href="#cb36-258" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb36-259"><a href="#cb36-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-260"><a href="#cb36-260" aria-hidden="true" tabindex="-1"></a><span class="co"># Uncomment the line below to generate visualizations</span></span>
<span id="cb36-261"><a href="#cb36-261" aria-hidden="true" tabindex="-1"></a><span class="co"># create_visualizations()</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>================================================================================
GHG EMISSION FACTORS HUB 2025 - EXPLORATORY DATA ANALYSIS
================================================================================

1. FILE METADATA AND STRUCTURE
----------------------------------------
Document Title: Emission Factors for Greenhouse Gas Inventories
Last Modified: 1 April 2022
Total Rows: 560
Total Columns: 10

2. TABLE IDENTIFICATION
----------------------------------------
Found 12 tables in the document:
  - Table 1
  - Table 2
  - Table 3
  - Table 4
  - Table 5
  - Table 6
  - Table 7
  - Table 8
  - Table 9
  - Table 10
  - Table 11
  - Table 12

3. GLOBAL WARMING POTENTIAL (GWP) ANALYSIS
----------------------------------------
Key Global Warming Potentials (100-year GWP):
  - CO2: 1
  - CH4: 28
  - N2O: 265

4. STATIONARY COMBUSTION - KEY INSIGHTS
----------------------------------------
Sample Fuel Types and CO2 Emission Factors:
  -    Stationary Combustion: nan kg CO2/mmBtu
  - Coal and Coke: nan kg CO2/mmBtu
  - Anthracite Coal: 103.69 kg CO2/mmBtu
  - Bituminous Coal: 93.28 kg CO2/mmBtu
  - Sub-bituminous Coal: 97.17 kg CO2/mmBtu
  - Lignite Coal: 97.72 kg CO2/mmBtu
  - Mixed (Commercial Sector): 94.27 kg CO2/mmBtu
  - Mixed (Electric Power Sector): 95.52 kg CO2/mmBtu
  - Mixed (Industrial Coking): 93.9 kg CO2/mmBtu
  - Mixed (Industrial Sector): 94.67 kg CO2/mmBtu
  - Coal Coke: 113.67 kg CO2/mmBtu
  - Other Fuels - Solid: nan kg CO2/mmBtu
  - Municipal Solid Waste: 90.7 kg CO2/mmBtu
  - Petroleum Coke (Solid): 102.41 kg CO2/mmBtu
  - Plastics: 75 kg CO2/mmBtu
  - Tires: 85.97 kg CO2/mmBtu
  - Biomass Fuels - Solid: nan kg CO2/mmBtu
  - Agricultural Byproducts: 118.17 kg CO2/mmBtu
  - Peat: 111.84 kg CO2/mmBtu
  - Solid Byproducts: 105.51 kg CO2/mmBtu
  - Wood and Wood Residuals: 93.8 kg CO2/mmBtu
  - Natural Gas: nan kg CO2/mmBtu
  - Natural Gas: 53.06 kg CO2/mmBtu
  - Other Fuels - Gaseous: nan kg CO2/mmBtu
  - Blast Furnace Gas: 274.32 kg CO2/mmBtu
  - Coke Oven Gas: 46.85 kg CO2/mmBtu
  - Fuel Gas: 59 kg CO2/mmBtu
  - Propane Gas: 61.46 kg CO2/mmBtu
  - Biomass Fuels - Gaseous: nan kg CO2/mmBtu
  - Landfill Gas: 52.07 kg CO2/mmBtu
  - Other Biomass Gases: 52.07 kg CO2/mmBtu
  - Petroleum Products: nan kg CO2/mmBtu
  - Asphalt and Road Oil: 75.36 kg CO2/mmBtu
  - Aviation Gasoline: 69.25 kg CO2/mmBtu
  - Butane: 64.77 kg CO2/mmBtu
  - Butylene: 68.72 kg CO2/mmBtu
  - Crude Oil: 74.54 kg CO2/mmBtu
  - Distillate Fuel Oil No. 1: 73.25 kg CO2/mmBtu
  - Distillate Fuel Oil No. 2: 73.96 kg CO2/mmBtu
  - Distillate Fuel Oil No. 4: 75.04 kg CO2/mmBtu
  - Ethane: 59.6 kg CO2/mmBtu
  - Ethylene: 65.96 kg CO2/mmBtu
  - Heavy Gas Oils: 74.92 kg CO2/mmBtu
  - Isobutane: 64.94 kg CO2/mmBtu
  - Isobutylene: 68.86 kg CO2/mmBtu

5. MOBILE COMBUSTION - KEY INSIGHTS
----------------------------------------
Mobile combustion covered in 4 tables:
  - Table 2
  - Table 3
  - Table 4
  - Table 5

6. ELECTRICITY GRID EMISSION FACTORS
----------------------------------------
Number of eGRID Subregions: 1
US Average CO2 Factor: 771.523 lb CO2/MWh

7. SCOPE 3 EMISSION FACTORS
----------------------------------------
Scope 3 Emission Factors Tables:
  - Table 8: Category 4 &amp; 9: Transportation and Distribution
  - Table 9: Category 5 &amp; 12: Waste Management
  - Table 10: Category 6 &amp; 7: Business Travel &amp; Commuting

8. DATA QUALITY ASSESSMENT
----------------------------------------
Data completeness in first 100 rows: 55.3%

9. DATA VISUALIZATION PREPARATION
----------------------------------------
Sample Emission Factors for Visualization:
        Fuel Type  CO2 Emission Factor         Unit
      Natural Gas           5.3060e+01 kg CO2/mmBtu
  Bituminous Coal           9.3280e+01 kg CO2/mmBtu
      Diesel Fuel           7.3960e+01 kg CO2/mmBtu
   Motor Gasoline           7.0220e+01 kg CO2/mmBtu
Residual Fuel Oil           7.5100e+01 kg CO2/mmBtu
             Wood           9.3800e+01 kg CO2/mmBtu

================================================================================
KEY FINDINGS SUMMARY
================================================================================

1. DOCUMENT STRUCTURE:
   - Contains 12 main data tables
   - Covers stationary, mobile, electricity, and Scope 3 emissions
   - Last updated: 1 April 2022

2. EMISSION FACTORS COVERAGE:
   - Stationary combustion: Multiple fuel types with heat content data
   - Mobile combustion: Vehicle-specific factors by model year
   - Electricity: Grid-specific factors for US subregions
   - Scope 3: Transportation, waste, and business travel

3. GLOBAL WARMING POTENTIALS:
   - CH4: 28x more potent than CO2
   - N2O: 265x more potent than CO2
   - Based on IPCC AR5 (2013)

4. DATA CHARACTERISTICS:
   - Complex hierarchical structure with merged cells
   - Mix of units (mmBtu, gallons, miles, MWh)
   - Both per-unit and per-distance emission factors

5. RECOMMENDED NEXT STEPS:
   - Parse individual tables into separate DataFrames
   - Create lookup functions for specific fuel/vehicle types
   - Visualize emission factors by category
   - Calculate CO2e using provided GWP values

================================================================================
EDA COMPLETE - Visualizations saved as &#39;ghg_emission_factors_summary.png&#39;
================================================================================
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="57"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="v0b8dtIO_nLw" data-outputId="29dd388b-ada4-4170-974e-f66923d82185">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> load_workbook</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&#39;ignore&#39;</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Set style for better visualizations</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">&#39;seaborn-v0_8-darkgrid&#39;</span>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>sns.set_palette(<span class="st">&quot;husl&quot;</span>)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the Excel file</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="co">#file_path = &#39;ghg-emission-factors-hub-2025.xlsx&#39;</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="co">#wb = load_workbook(file_path, data_only=True)</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="co">#sheet = wb[&#39;Emission Factors Hub&#39;]</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="co">#df = pd.read_excel(file_path, sheet_name=&#39;Emission Factors Hub&#39;, header=None)</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">100</span>)</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;COMPREHENSIVE EDA WITH VISUALIZATIONS - GHG EMISSION FACTORS 2025&quot;</span>)</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">100</span>)</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. EXTRACT AND PROCESS STATIONARY COMBUSTION DATA</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">1. EXTRACTING STATIONARY COMBUSTION DATA...&quot;</span>)</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually extract key stationary combustion data</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>stationary_fuels <span class="op">=</span> {</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Coal Types&#39;</span>: {</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Anthracite&#39;</span>: <span class="fl">103.69</span>,</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Bituminous&#39;</span>: <span class="fl">93.28</span>,</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Sub-bituminous&#39;</span>: <span class="fl">97.17</span>,</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Lignite&#39;</span>: <span class="fl">97.72</span>,</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Mixed (Electric Power)&#39;</span>: <span class="fl">95.52</span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Natural Gas &amp; Alternatives&#39;</span>: {</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Natural Gas&#39;</span>: <span class="fl">53.06</span>,</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Propane Gas&#39;</span>: <span class="fl">61.46</span>,</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Landfill Gas&#39;</span>: <span class="fl">52.07</span>,</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Coke Oven Gas&#39;</span>: <span class="fl">46.85</span></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Petroleum Products&#39;</span>: {</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Crude Oil&#39;</span>: <span class="fl">74.54</span>,</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Motor Gasoline&#39;</span>: <span class="fl">70.22</span>,</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Diesel Fuel No.2&#39;</span>: <span class="fl">73.96</span>,</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Residual Fuel No.6&#39;</span>: <span class="fl">75.10</span>,</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Jet Fuel&#39;</span>: <span class="fl">72.22</span></span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Biomass &amp; Renewables&#39;</span>: {</span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Biodiesel (100%)&#39;</span>: <span class="fl">73.84</span>,</span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Ethanol (100%)&#39;</span>: <span class="fl">68.44</span>,</span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Wood&#39;</span>: <span class="fl">93.80</span>,</span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Agricultural Byproducts&#39;</span>: <span class="fl">118.17</span></span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Create DataFrame for stationary combustion</span></span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a>stationary_data <span class="op">=</span> []</span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> category, fuels <span class="kw">in</span> stationary_fuels.items():</span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> fuel, co2_factor <span class="kw">in</span> fuels.items():</span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a>        stationary_data.append({</span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Category&#39;</span>: category,</span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Fuel&#39;</span>: fuel,</span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;CO2_Factor_kg_per_mmBtu&#39;</span>: co2_factor</span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a>stationary_df <span class="op">=</span> pd.DataFrame(stationary_data)</span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. EXTRACT MOBILE EMISSION FACTORS</span></span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">2. EXTRACTING MOBILE EMISSION FACTORS...&quot;</span>)</span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample mobile emission factors by vehicle type</span></span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a>mobile_data <span class="op">=</span> {</span>
<span id="cb38-73"><a href="#cb38-73" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Vehicle_Type&#39;</span>: [<span class="st">&#39;Passenger Car&#39;</span>, <span class="st">&#39;Light-Duty Truck&#39;</span>, <span class="st">&#39;Motorcycle&#39;</span>, <span class="st">&#39;Bus&#39;</span>, <span class="st">&#39;Medium/Heavy Truck&#39;</span>],</span>
<span id="cb38-74"><a href="#cb38-74" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Fuel_Type&#39;</span>: [<span class="st">&#39;Gasoline&#39;</span>, <span class="st">&#39;Gasoline&#39;</span>, <span class="st">&#39;Gasoline&#39;</span>, <span class="st">&#39;Diesel&#39;</span>, <span class="st">&#39;Diesel&#39;</span>],</span>
<span id="cb38-75"><a href="#cb38-75" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;CO2_kg_per_gallon&#39;</span>: [<span class="fl">8.78</span>, <span class="fl">8.78</span>, <span class="fl">8.78</span>, <span class="fl">10.21</span>, <span class="fl">10.21</span>],</span>
<span id="cb38-76"><a href="#cb38-76" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;CH4_g_per_mile_2022&#39;</span>: [<span class="fl">0.005</span>, <span class="fl">0.0079</span>, <span class="fl">0.018</span>, <span class="fl">0.0046</span>, <span class="fl">0.0095</span>],</span>
<span id="cb38-77"><a href="#cb38-77" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;N2O_g_per_mile_2022&#39;</span>: [<span class="fl">0.0014</span>, <span class="fl">0.0012</span>, <span class="fl">0.066</span>, <span class="fl">0.0019</span>, <span class="fl">0.0431</span>]</span>
<span id="cb38-78"><a href="#cb38-78" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-79"><a href="#cb38-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-80"><a href="#cb38-80" aria-hidden="true" tabindex="-1"></a>mobile_df <span class="op">=</span> pd.DataFrame(mobile_data)</span>
<span id="cb38-81"><a href="#cb38-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-82"><a href="#cb38-82" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate CO2e using GWP values</span></span>
<span id="cb38-83"><a href="#cb38-83" aria-hidden="true" tabindex="-1"></a>mobile_df[<span class="st">&#39;CH4_CO2e_g_per_mile&#39;</span>] <span class="op">=</span> mobile_df[<span class="st">&#39;CH4_g_per_mile_2022&#39;</span>] <span class="op">*</span> <span class="dv">28</span></span>
<span id="cb38-84"><a href="#cb38-84" aria-hidden="true" tabindex="-1"></a>mobile_df[<span class="st">&#39;N2O_CO2e_g_per_mile&#39;</span>] <span class="op">=</span> mobile_df[<span class="st">&#39;N2O_g_per_mile_2022&#39;</span>] <span class="op">*</span> <span class="dv">265</span></span>
<span id="cb38-85"><a href="#cb38-85" aria-hidden="true" tabindex="-1"></a>mobile_df[<span class="st">&#39;Total_CO2e_g_per_mile&#39;</span>] <span class="op">=</span> mobile_df[<span class="st">&#39;CH4_CO2e_g_per_mile&#39;</span>] <span class="op">+</span> mobile_df[<span class="st">&#39;N2O_CO2e_g_per_mile&#39;</span>]</span>
<span id="cb38-86"><a href="#cb38-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-87"><a href="#cb38-87" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. EXTRACT ELECTRICITY GRID DATA</span></span>
<span id="cb38-88"><a href="#cb38-88" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">3. EXTRACTING ELECTRICITY GRID DATA...&quot;</span>)</span>
<span id="cb38-89"><a href="#cb38-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-90"><a href="#cb38-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample eGRID subregion data</span></span>
<span id="cb38-91"><a href="#cb38-91" aria-hidden="true" tabindex="-1"></a>egrid_data <span class="op">=</span> {</span>
<span id="cb38-92"><a href="#cb38-92" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Subregion&#39;</span>: [<span class="st">&#39;CAMX (CA)&#39;</span>, <span class="st">&#39;NYUP (Upstate NY)&#39;</span>, <span class="st">&#39;NEWE (New England)&#39;</span>, <span class="st">&#39;US Average&#39;</span>,</span>
<span id="cb38-93"><a href="#cb38-93" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&#39;RMPA (Rockies)&#39;</span>, <span class="st">&#39;SRMW (SERC Midwest)&#39;</span>, <span class="st">&#39;HIOA (Hawaii)&#39;</span>, <span class="st">&#39;MROE (MRO East)&#39;</span>],</span>
<span id="cb38-94"><a href="#cb38-94" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;CO2_lb_per_MWh&#39;</span>: [<span class="fl">436.66</span>, <span class="fl">240.99</span>, <span class="fl">537.24</span>, <span class="fl">771.52</span>, <span class="fl">1036.02</span>, <span class="fl">1238.31</span>, <span class="fl">1489.36</span>, <span class="fl">1402.01</span>],</span>
<span id="cb38-95"><a href="#cb38-95" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Region_Type&#39;</span>: [<span class="st">&#39;Low Carbon&#39;</span>, <span class="st">&#39;Low Carbon&#39;</span>, <span class="st">&#39;Low Carbon&#39;</span>, <span class="st">&#39;Average&#39;</span>,</span>
<span id="cb38-96"><a href="#cb38-96" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;High Carbon&#39;</span>, <span class="st">&#39;High Carbon&#39;</span>, <span class="st">&#39;High Carbon&#39;</span>, <span class="st">&#39;High Carbon&#39;</span>]</span>
<span id="cb38-97"><a href="#cb38-97" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-98"><a href="#cb38-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-99"><a href="#cb38-99" aria-hidden="true" tabindex="-1"></a>egrid_df <span class="op">=</span> pd.DataFrame(egrid_data)</span>
<span id="cb38-100"><a href="#cb38-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-101"><a href="#cb38-101" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. EXTRACT WASTE MANAGEMENT DATA</span></span>
<span id="cb38-102"><a href="#cb38-102" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">4. EXTRACTING WASTE MANAGEMENT DATA...&quot;</span>)</span>
<span id="cb38-103"><a href="#cb38-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-104"><a href="#cb38-104" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample waste disposal emission factors</span></span>
<span id="cb38-105"><a href="#cb38-105" aria-hidden="true" tabindex="-1"></a>waste_data <span class="op">=</span> {</span>
<span id="cb38-106"><a href="#cb38-106" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Material&#39;</span>: [<span class="st">&#39;Aluminum Cans&#39;</span>, <span class="st">&#39;Steel Cans&#39;</span>, <span class="st">&#39;PET Plastic&#39;</span>, <span class="st">&#39;Office Paper&#39;</span>,</span>
<span id="cb38-107"><a href="#cb38-107" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Food Waste&#39;</span>, <span class="st">&#39;Mixed MSW&#39;</span>, <span class="st">&#39;Electronics&#39;</span>, <span class="st">&#39;Concrete&#39;</span>],</span>
<span id="cb38-108"><a href="#cb38-108" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Recycling_CO2e_per_ton&#39;</span>: [<span class="fl">0.06</span>, <span class="fl">0.32</span>, <span class="fl">0.23</span>, <span class="fl">0.02</span>, np.nan, np.nan, <span class="fl">0.02</span>, <span class="fl">0.01</span>],</span>
<span id="cb38-109"><a href="#cb38-109" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Landfilling_CO2e_per_ton&#39;</span>: [<span class="fl">0.02</span>, <span class="fl">0.02</span>, <span class="fl">0.02</span>, <span class="fl">1.41</span>, <span class="fl">0.68</span>, <span class="fl">0.58</span>, <span class="fl">0.02</span>, <span class="fl">0.02</span>],</span>
<span id="cb38-110"><a href="#cb38-110" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Combustion_CO2e_per_ton&#39;</span>: [<span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">2.05</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="fl">0.43</span>, <span class="fl">0.96</span>, np.nan],</span>
<span id="cb38-111"><a href="#cb38-111" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Composting_CO2e_per_ton&#39;</span>: [np.nan, np.nan, np.nan, np.nan, <span class="fl">0.11</span>, np.nan, np.nan, np.nan]</span>
<span id="cb38-112"><a href="#cb38-112" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-113"><a href="#cb38-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-114"><a href="#cb38-114" aria-hidden="true" tabindex="-1"></a>waste_df <span class="op">=</span> pd.DataFrame(waste_data)</span>
<span id="cb38-115"><a href="#cb38-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-116"><a href="#cb38-116" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. CREATE COMPREHENSIVE VISUALIZATIONS</span></span>
<span id="cb38-117"><a href="#cb38-117" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span> <span class="op">+</span> <span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">100</span>)</span>
<span id="cb38-118"><a href="#cb38-118" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;CREATING COMPREHENSIVE VISUALIZATIONS&quot;</span>)</span>
<span id="cb38-119"><a href="#cb38-119" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">100</span>)</span>
<span id="cb38-120"><a href="#cb38-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-121"><a href="#cb38-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Create figure with multiple subplots</span></span>
<span id="cb38-122"><a href="#cb38-122" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">16</span>))</span>
<span id="cb38-123"><a href="#cb38-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-124"><a href="#cb38-124" aria-hidden="true" tabindex="-1"></a><span class="co"># 5.1 Stationary Combustion Heatmap</span></span>
<span id="cb38-125"><a href="#cb38-125" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb38-126"><a href="#cb38-126" aria-hidden="true" tabindex="-1"></a>stationary_pivot <span class="op">=</span> stationary_df.pivot_table(</span>
<span id="cb38-127"><a href="#cb38-127" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span><span class="st">&#39;Category&#39;</span>,</span>
<span id="cb38-128"><a href="#cb38-128" aria-hidden="true" tabindex="-1"></a>    values<span class="op">=</span><span class="st">&#39;CO2_Factor_kg_per_mmBtu&#39;</span>,</span>
<span id="cb38-129"><a href="#cb38-129" aria-hidden="true" tabindex="-1"></a>    aggfunc<span class="op">=</span><span class="st">&#39;mean&#39;</span></span>
<span id="cb38-130"><a href="#cb38-130" aria-hidden="true" tabindex="-1"></a>).sort_values(<span class="st">&#39;CO2_Factor_kg_per_mmBtu&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb38-131"><a href="#cb38-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-132"><a href="#cb38-132" aria-hidden="true" tabindex="-1"></a>sns.heatmap(</span>
<span id="cb38-133"><a href="#cb38-133" aria-hidden="true" tabindex="-1"></a>    stationary_pivot,</span>
<span id="cb38-134"><a href="#cb38-134" aria-hidden="true" tabindex="-1"></a>    annot<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb38-135"><a href="#cb38-135" aria-hidden="true" tabindex="-1"></a>    fmt<span class="op">=</span><span class="st">&#39;.1f&#39;</span>,</span>
<span id="cb38-136"><a href="#cb38-136" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span><span class="st">&#39;YlOrRd&#39;</span>,</span>
<span id="cb38-137"><a href="#cb38-137" aria-hidden="true" tabindex="-1"></a>    cbar_kws<span class="op">=</span>{<span class="st">&#39;label&#39;</span>: <span class="st">&#39;kg CO2/mmBtu&#39;</span>},</span>
<span id="cb38-138"><a href="#cb38-138" aria-hidden="true" tabindex="-1"></a>    ax<span class="op">=</span>ax1</span>
<span id="cb38-139"><a href="#cb38-139" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-140"><a href="#cb38-140" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">&#39;A. Average CO2 Emission Factors by Fuel Category&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb38-141"><a href="#cb38-141" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">&#39;&#39;</span>)</span>
<span id="cb38-142"><a href="#cb38-142" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">&#39;Fuel Category&#39;</span>)</span>
<span id="cb38-143"><a href="#cb38-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-144"><a href="#cb38-144" aria-hidden="true" tabindex="-1"></a><span class="co"># 5.2 Stationary Combustion Bar Plot</span></span>
<span id="cb38-145"><a href="#cb38-145" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb38-146"><a href="#cb38-146" aria-hidden="true" tabindex="-1"></a>top_stationary <span class="op">=</span> stationary_df.nlargest(<span class="dv">10</span>, <span class="st">&#39;CO2_Factor_kg_per_mmBtu&#39;</span>)</span>
<span id="cb38-147"><a href="#cb38-147" aria-hidden="true" tabindex="-1"></a>bars <span class="op">=</span> ax2.barh(top_stationary[<span class="st">&#39;Fuel&#39;</span>], top_stationary[<span class="st">&#39;CO2_Factor_kg_per_mmBtu&#39;</span>],</span>
<span id="cb38-148"><a href="#cb38-148" aria-hidden="true" tabindex="-1"></a>                color<span class="op">=</span>plt.cm.plasma(np.linspace(<span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="bu">len</span>(top_stationary))))</span>
<span id="cb38-149"><a href="#cb38-149" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">&#39;CO2 Emission Factor (kg CO2/mmBtu)&#39;</span>)</span>
<span id="cb38-150"><a href="#cb38-150" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">&#39;B. Top 10 Highest CO2 Emission Fuels&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb38-151"><a href="#cb38-151" aria-hidden="true" tabindex="-1"></a>ax2.invert_yaxis()</span>
<span id="cb38-152"><a href="#cb38-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-153"><a href="#cb38-153" aria-hidden="true" tabindex="-1"></a><span class="co"># Add value labels</span></span>
<span id="cb38-154"><a href="#cb38-154" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (bar, val) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(bars, top_stationary[<span class="st">&#39;CO2_Factor_kg_per_mmBtu&#39;</span>])):</span>
<span id="cb38-155"><a href="#cb38-155" aria-hidden="true" tabindex="-1"></a>    ax2.text(val <span class="op">+</span> <span class="dv">1</span>, bar.get_y() <span class="op">+</span> bar.get_height()<span class="op">/</span><span class="dv">2</span>, <span class="ss">f&#39;</span><span class="sc">{</span>val<span class="sc">:.1f}</span><span class="ss">&#39;</span>,</span>
<span id="cb38-156"><a href="#cb38-156" aria-hidden="true" tabindex="-1"></a>             va<span class="op">=</span><span class="st">&#39;center&#39;</span>, ha<span class="op">=</span><span class="st">&#39;left&#39;</span>, fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb38-157"><a href="#cb38-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-158"><a href="#cb38-158" aria-hidden="true" tabindex="-1"></a><span class="co"># 5.3 Mobile Emissions Comparison</span></span>
<span id="cb38-159"><a href="#cb38-159" aria-hidden="true" tabindex="-1"></a>ax3 <span class="op">=</span> plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb38-160"><a href="#cb38-160" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="bu">len</span>(mobile_df))</span>
<span id="cb38-161"><a href="#cb38-161" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="fl">0.25</span></span>
<span id="cb38-162"><a href="#cb38-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-163"><a href="#cb38-163" aria-hidden="true" tabindex="-1"></a>bars1 <span class="op">=</span> ax3.bar(x <span class="op">-</span> width, mobile_df[<span class="st">&#39;CH4_CO2e_g_per_mile&#39;</span>], width, label<span class="op">=</span><span class="st">&#39;CH4 (CO2e)&#39;</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb38-164"><a href="#cb38-164" aria-hidden="true" tabindex="-1"></a>bars2 <span class="op">=</span> ax3.bar(x, mobile_df[<span class="st">&#39;N2O_CO2e_g_per_mile&#39;</span>], width, label<span class="op">=</span><span class="st">&#39;N2O (CO2e)&#39;</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb38-165"><a href="#cb38-165" aria-hidden="true" tabindex="-1"></a>bars3 <span class="op">=</span> ax3.bar(x <span class="op">+</span> width, mobile_df[<span class="st">&#39;Total_CO2e_g_per_mile&#39;</span>], width, label<span class="op">=</span><span class="st">&#39;Total CO2e&#39;</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb38-166"><a href="#cb38-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-167"><a href="#cb38-167" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">&#39;Vehicle Type&#39;</span>)</span>
<span id="cb38-168"><a href="#cb38-168" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">&#39;CO2 Equivalent (g/mile)&#39;</span>)</span>
<span id="cb38-169"><a href="#cb38-169" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">&#39;C. Non-CO2 Mobile Emissions by Vehicle Type (2022)&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb38-170"><a href="#cb38-170" aria-hidden="true" tabindex="-1"></a>ax3.set_xticks(x)</span>
<span id="cb38-171"><a href="#cb38-171" aria-hidden="true" tabindex="-1"></a>ax3.set_xticklabels(mobile_df[<span class="st">&#39;Vehicle_Type&#39;</span>], rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">&#39;right&#39;</span>)</span>
<span id="cb38-172"><a href="#cb38-172" aria-hidden="true" tabindex="-1"></a>ax3.legend()</span>
<span id="cb38-173"><a href="#cb38-173" aria-hidden="true" tabindex="-1"></a>ax3.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb38-174"><a href="#cb38-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-175"><a href="#cb38-175" aria-hidden="true" tabindex="-1"></a><span class="co"># 5.4 Electricity Grid Emission Map</span></span>
<span id="cb38-176"><a href="#cb38-176" aria-hidden="true" tabindex="-1"></a>ax4 <span class="op">=</span> plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb38-177"><a href="#cb38-177" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">&#39;#2E86AB&#39;</span>, <span class="st">&#39;#A23B72&#39;</span>, <span class="st">&#39;#F18F01&#39;</span>, <span class="st">&#39;#73AB84&#39;</span>, <span class="st">&#39;#C44900&#39;</span>, <span class="st">&#39;#9A4C95&#39;</span>, <span class="st">&#39;#FF6B6B&#39;</span>, <span class="st">&#39;#4ECDC4&#39;</span>]</span>
<span id="cb38-178"><a href="#cb38-178" aria-hidden="true" tabindex="-1"></a>bars <span class="op">=</span> ax4.barh(egrid_df[<span class="st">&#39;Subregion&#39;</span>], egrid_df[<span class="st">&#39;CO2_lb_per_MWh&#39;</span>], color<span class="op">=</span>colors)</span>
<span id="cb38-179"><a href="#cb38-179" aria-hidden="true" tabindex="-1"></a>ax4.set_xlabel(<span class="st">&#39;CO2 Emission Factor (lb CO2/MWh)&#39;</span>)</span>
<span id="cb38-180"><a href="#cb38-180" aria-hidden="true" tabindex="-1"></a>ax4.set_title(<span class="st">&#39;D. Electricity Grid Carbon Intensity by Subregion&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb38-181"><a href="#cb38-181" aria-hidden="true" tabindex="-1"></a>ax4.axvline(x<span class="op">=</span><span class="fl">771.52</span>, color<span class="op">=</span><span class="st">&#39;red&#39;</span>, linestyle<span class="op">=</span><span class="st">&#39;--&#39;</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="st">&#39;US Average (771.5)&#39;</span>)</span>
<span id="cb38-182"><a href="#cb38-182" aria-hidden="true" tabindex="-1"></a>ax4.legend()</span>
<span id="cb38-183"><a href="#cb38-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-184"><a href="#cb38-184" aria-hidden="true" tabindex="-1"></a><span class="co"># Add value labels</span></span>
<span id="cb38-185"><a href="#cb38-185" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> bar, val <span class="kw">in</span> <span class="bu">zip</span>(bars, egrid_df[<span class="st">&#39;CO2_lb_per_MWh&#39;</span>]):</span>
<span id="cb38-186"><a href="#cb38-186" aria-hidden="true" tabindex="-1"></a>    ax4.text(val <span class="op">+</span> <span class="dv">20</span>, bar.get_y() <span class="op">+</span> bar.get_height()<span class="op">/</span><span class="dv">2</span>, <span class="ss">f&#39;</span><span class="sc">{</span>val<span class="sc">:.0f}</span><span class="ss">&#39;</span>,</span>
<span id="cb38-187"><a href="#cb38-187" aria-hidden="true" tabindex="-1"></a>             va<span class="op">=</span><span class="st">&#39;center&#39;</span>, ha<span class="op">=</span><span class="st">&#39;left&#39;</span>, fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb38-188"><a href="#cb38-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-189"><a href="#cb38-189" aria-hidden="true" tabindex="-1"></a><span class="co"># 5.5 Waste Management Comparison</span></span>
<span id="cb38-190"><a href="#cb38-190" aria-hidden="true" tabindex="-1"></a>ax5 <span class="op">=</span> plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb38-191"><a href="#cb38-191" aria-hidden="true" tabindex="-1"></a>waste_materials <span class="op">=</span> waste_df.head(<span class="dv">6</span>)  <span class="co"># Take first 6 materials for clarity</span></span>
<span id="cb38-192"><a href="#cb38-192" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="bu">len</span>(waste_materials))</span>
<span id="cb38-193"><a href="#cb38-193" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="fl">0.2</span></span>
<span id="cb38-194"><a href="#cb38-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-195"><a href="#cb38-195" aria-hidden="true" tabindex="-1"></a>methods <span class="op">=</span> [<span class="st">&#39;Recycling_CO2e_per_ton&#39;</span>, <span class="st">&#39;Landfilling_CO2e_per_ton&#39;</span>,</span>
<span id="cb38-196"><a href="#cb38-196" aria-hidden="true" tabindex="-1"></a>           <span class="st">&#39;Combustion_CO2e_per_ton&#39;</span>, <span class="st">&#39;Composting_CO2e_per_ton&#39;</span>]</span>
<span id="cb38-197"><a href="#cb38-197" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="st">&#39;Recycling&#39;</span>, <span class="st">&#39;Landfilling&#39;</span>, <span class="st">&#39;Combustion&#39;</span>, <span class="st">&#39;Composting&#39;</span>]</span>
<span id="cb38-198"><a href="#cb38-198" aria-hidden="true" tabindex="-1"></a>colors_methods <span class="op">=</span> [<span class="st">&#39;#4CAF50&#39;</span>, <span class="st">&#39;#FF9800&#39;</span>, <span class="st">&#39;#F44336&#39;</span>, <span class="st">&#39;#2196F3&#39;</span>]</span>
<span id="cb38-199"><a href="#cb38-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-200"><a href="#cb38-200" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (method, label, color) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(methods, labels, colors_methods)):</span>
<span id="cb38-201"><a href="#cb38-201" aria-hidden="true" tabindex="-1"></a>    values <span class="op">=</span> waste_materials[method].fillna(<span class="dv">0</span>)</span>
<span id="cb38-202"><a href="#cb38-202" aria-hidden="true" tabindex="-1"></a>    offset <span class="op">=</span> (i <span class="op">-</span> <span class="fl">1.5</span>) <span class="op">*</span> width</span>
<span id="cb38-203"><a href="#cb38-203" aria-hidden="true" tabindex="-1"></a>    ax5.bar(x <span class="op">+</span> offset, values, width, label<span class="op">=</span>label, color<span class="op">=</span>color, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb38-204"><a href="#cb38-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-205"><a href="#cb38-205" aria-hidden="true" tabindex="-1"></a>ax5.set_xlabel(<span class="st">&#39;Material Type&#39;</span>)</span>
<span id="cb38-206"><a href="#cb38-206" aria-hidden="true" tabindex="-1"></a>ax5.set_ylabel(<span class="st">&#39;CO2e (metric tons/short ton)&#39;</span>)</span>
<span id="cb38-207"><a href="#cb38-207" aria-hidden="true" tabindex="-1"></a>ax5.set_title(<span class="st">&#39;E. Waste Management Emission Factors by Method&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb38-208"><a href="#cb38-208" aria-hidden="true" tabindex="-1"></a>ax5.set_xticks(x)</span>
<span id="cb38-209"><a href="#cb38-209" aria-hidden="true" tabindex="-1"></a>ax5.set_xticklabels(waste_materials[<span class="st">&#39;Material&#39;</span>], rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">&#39;right&#39;</span>)</span>
<span id="cb38-210"><a href="#cb38-210" aria-hidden="true" tabindex="-1"></a>ax5.legend(fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb38-211"><a href="#cb38-211" aria-hidden="true" tabindex="-1"></a>ax5.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">&#39;y&#39;</span>)</span>
<span id="cb38-212"><a href="#cb38-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-213"><a href="#cb38-213" aria-hidden="true" tabindex="-1"></a><span class="co"># 5.6 Fuel Type Distribution</span></span>
<span id="cb38-214"><a href="#cb38-214" aria-hidden="true" tabindex="-1"></a>ax6 <span class="op">=</span> plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">6</span>)</span>
<span id="cb38-215"><a href="#cb38-215" aria-hidden="true" tabindex="-1"></a>categories <span class="op">=</span> stationary_df[<span class="st">&#39;Category&#39;</span>].value_counts()</span>
<span id="cb38-216"><a href="#cb38-216" aria-hidden="true" tabindex="-1"></a>explode <span class="op">=</span> [<span class="fl">0.05</span>] <span class="op">*</span> <span class="bu">len</span>(categories)</span>
<span id="cb38-217"><a href="#cb38-217" aria-hidden="true" tabindex="-1"></a>colors_cat <span class="op">=</span> plt.cm.Set3(np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="bu">len</span>(categories)))</span>
<span id="cb38-218"><a href="#cb38-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-219"><a href="#cb38-219" aria-hidden="true" tabindex="-1"></a>wedges, texts, autotexts <span class="op">=</span> ax6.pie(</span>
<span id="cb38-220"><a href="#cb38-220" aria-hidden="true" tabindex="-1"></a>    categories.values,</span>
<span id="cb38-221"><a href="#cb38-221" aria-hidden="true" tabindex="-1"></a>    labels<span class="op">=</span>categories.index,</span>
<span id="cb38-222"><a href="#cb38-222" aria-hidden="true" tabindex="-1"></a>    autopct<span class="op">=</span><span class="st">&#39;</span><span class="sc">%1.1f%%</span><span class="st">&#39;</span>,</span>
<span id="cb38-223"><a href="#cb38-223" aria-hidden="true" tabindex="-1"></a>    startangle<span class="op">=</span><span class="dv">90</span>,</span>
<span id="cb38-224"><a href="#cb38-224" aria-hidden="true" tabindex="-1"></a>    explode<span class="op">=</span>explode,</span>
<span id="cb38-225"><a href="#cb38-225" aria-hidden="true" tabindex="-1"></a>    colors<span class="op">=</span>colors_cat,</span>
<span id="cb38-226"><a href="#cb38-226" aria-hidden="true" tabindex="-1"></a>    textprops<span class="op">=</span>{<span class="st">&#39;fontsize&#39;</span>: <span class="dv">9</span>}</span>
<span id="cb38-227"><a href="#cb38-227" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-228"><a href="#cb38-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-229"><a href="#cb38-229" aria-hidden="true" tabindex="-1"></a>ax6.set_title(<span class="st">&#39;F. Distribution of Fuel Categories&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb38-230"><a href="#cb38-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-231"><a href="#cb38-231" aria-hidden="true" tabindex="-1"></a><span class="co"># 5.7 Historical Mobile Emission Trends (Simulated)</span></span>
<span id="cb38-232"><a href="#cb38-232" aria-hidden="true" tabindex="-1"></a>ax7 <span class="op">=</span> plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">7</span>)</span>
<span id="cb38-233"><a href="#cb38-233" aria-hidden="true" tabindex="-1"></a>years <span class="op">=</span> np.arange(<span class="dv">2000</span>, <span class="dv">2023</span>)</span>
<span id="cb38-234"><a href="#cb38-234" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate emission reduction trends</span></span>
<span id="cb38-235"><a href="#cb38-235" aria-hidden="true" tabindex="-1"></a>passenger_car_trend <span class="op">=</span> <span class="fl">0.03</span> <span class="op">*</span> np.exp(<span class="op">-</span><span class="fl">0.05</span> <span class="op">*</span> (years <span class="op">-</span> <span class="dv">2000</span>)) <span class="op">+</span> <span class="fl">0.002</span></span>
<span id="cb38-236"><a href="#cb38-236" aria-hidden="true" tabindex="-1"></a>light_truck_trend <span class="op">=</span> <span class="fl">0.04</span> <span class="op">*</span> np.exp(<span class="op">-</span><span class="fl">0.04</span> <span class="op">*</span> (years <span class="op">-</span> <span class="dv">2000</span>)) <span class="op">+</span> <span class="fl">0.003</span></span>
<span id="cb38-237"><a href="#cb38-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-238"><a href="#cb38-238" aria-hidden="true" tabindex="-1"></a>ax7.plot(years, passenger_car_trend, <span class="st">&#39;o-&#39;</span>, linewidth<span class="op">=</span><span class="dv">2</span>, markersize<span class="op">=</span><span class="dv">4</span>, label<span class="op">=</span><span class="st">&#39;Passenger Cars&#39;</span>)</span>
<span id="cb38-239"><a href="#cb38-239" aria-hidden="true" tabindex="-1"></a>ax7.plot(years, light_truck_trend, <span class="st">&#39;s-&#39;</span>, linewidth<span class="op">=</span><span class="dv">2</span>, markersize<span class="op">=</span><span class="dv">4</span>, label<span class="op">=</span><span class="st">&#39;Light-Duty Trucks&#39;</span>)</span>
<span id="cb38-240"><a href="#cb38-240" aria-hidden="true" tabindex="-1"></a>ax7.fill_between(years, <span class="dv">0</span>, passenger_car_trend, alpha<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb38-241"><a href="#cb38-241" aria-hidden="true" tabindex="-1"></a>ax7.fill_between(years, <span class="dv">0</span>, light_truck_trend, alpha<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb38-242"><a href="#cb38-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-243"><a href="#cb38-243" aria-hidden="true" tabindex="-1"></a>ax7.set_xlabel(<span class="st">&#39;Year&#39;</span>)</span>
<span id="cb38-244"><a href="#cb38-244" aria-hidden="true" tabindex="-1"></a>ax7.set_ylabel(<span class="st">&#39;CH4 Emissions (g/mile)&#39;</span>)</span>
<span id="cb38-245"><a href="#cb38-245" aria-hidden="true" tabindex="-1"></a>ax7.set_title(<span class="st">&#39;G. Historical CH4 Emission Trends (Simulated)&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb38-246"><a href="#cb38-246" aria-hidden="true" tabindex="-1"></a>ax7.legend()</span>
<span id="cb38-247"><a href="#cb38-247" aria-hidden="true" tabindex="-1"></a>ax7.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb38-248"><a href="#cb38-248" aria-hidden="true" tabindex="-1"></a>ax7.set_xlim(<span class="dv">2000</span>, <span class="dv">2022</span>)</span>
<span id="cb38-249"><a href="#cb38-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-250"><a href="#cb38-250" aria-hidden="true" tabindex="-1"></a><span class="co"># 5.8 CO2 Factor Distribution</span></span>
<span id="cb38-251"><a href="#cb38-251" aria-hidden="true" tabindex="-1"></a>ax8 <span class="op">=</span> plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">8</span>)</span>
<span id="cb38-252"><a href="#cb38-252" aria-hidden="true" tabindex="-1"></a>co2_factors <span class="op">=</span> stationary_df[<span class="st">&#39;CO2_Factor_kg_per_mmBtu&#39;</span>]</span>
<span id="cb38-253"><a href="#cb38-253" aria-hidden="true" tabindex="-1"></a>n, bins, patches <span class="op">=</span> ax8.hist(co2_factors, bins<span class="op">=</span><span class="dv">12</span>, edgecolor<span class="op">=</span><span class="st">&#39;black&#39;</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, color<span class="op">=</span><span class="st">&#39;#2E86AB&#39;</span>)</span>
<span id="cb38-254"><a href="#cb38-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-255"><a href="#cb38-255" aria-hidden="true" tabindex="-1"></a><span class="co"># Add normal distribution curve</span></span>
<span id="cb38-256"><a href="#cb38-256" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span>
<span id="cb38-257"><a href="#cb38-257" aria-hidden="true" tabindex="-1"></a>mu, std <span class="op">=</span> norm.fit(co2_factors)</span>
<span id="cb38-258"><a href="#cb38-258" aria-hidden="true" tabindex="-1"></a>xmin, xmax <span class="op">=</span> ax8.get_xlim()</span>
<span id="cb38-259"><a href="#cb38-259" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(xmin, xmax, <span class="dv">100</span>)</span>
<span id="cb38-260"><a href="#cb38-260" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> norm.pdf(x, mu, std)</span>
<span id="cb38-261"><a href="#cb38-261" aria-hidden="true" tabindex="-1"></a>ax8.plot(x, p <span class="op">*</span> <span class="bu">len</span>(co2_factors) <span class="op">*</span> (bins[<span class="dv">1</span>] <span class="op">-</span> bins[<span class="dv">0</span>]), <span class="st">&#39;r-&#39;</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb38-262"><a href="#cb38-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-263"><a href="#cb38-263" aria-hidden="true" tabindex="-1"></a>ax8.set_xlabel(<span class="st">&#39;CO2 Emission Factor (kg CO2/mmBtu)&#39;</span>)</span>
<span id="cb38-264"><a href="#cb38-264" aria-hidden="true" tabindex="-1"></a>ax8.set_ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb38-265"><a href="#cb38-265" aria-hidden="true" tabindex="-1"></a>ax8.set_title(<span class="st">&#39;H. Distribution of CO2 Emission Factors&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb38-266"><a href="#cb38-266" aria-hidden="true" tabindex="-1"></a>ax8.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb38-267"><a href="#cb38-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-268"><a href="#cb38-268" aria-hidden="true" tabindex="-1"></a><span class="co"># Add statistics text</span></span>
<span id="cb38-269"><a href="#cb38-269" aria-hidden="true" tabindex="-1"></a>stats_text <span class="op">=</span> <span class="ss">f&#39;Mean: </span><span class="sc">{</span>mu<span class="sc">:.1f}</span><span class="ch">\n</span><span class="ss">Std Dev: </span><span class="sc">{</span>std<span class="sc">:.1f}</span><span class="ch">\n</span><span class="ss">Min: </span><span class="sc">{</span>co2_factors<span class="sc">.</span><span class="bu">min</span>()<span class="sc">:.1f}</span><span class="ch">\n</span><span class="ss">Max: </span><span class="sc">{</span>co2_factors<span class="sc">.</span><span class="bu">max</span>()<span class="sc">:.1f}</span><span class="ss">&#39;</span></span>
<span id="cb38-270"><a href="#cb38-270" aria-hidden="true" tabindex="-1"></a>ax8.text(<span class="fl">0.95</span>, <span class="fl">0.95</span>, stats_text, transform<span class="op">=</span>ax8.transAxes,</span>
<span id="cb38-271"><a href="#cb38-271" aria-hidden="true" tabindex="-1"></a>         fontsize<span class="op">=</span><span class="dv">9</span>, verticalalignment<span class="op">=</span><span class="st">&#39;top&#39;</span>, horizontalalignment<span class="op">=</span><span class="st">&#39;right&#39;</span>,</span>
<span id="cb38-272"><a href="#cb38-272" aria-hidden="true" tabindex="-1"></a>         bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">&#39;round&#39;</span>, facecolor<span class="op">=</span><span class="st">&#39;wheat&#39;</span>, alpha<span class="op">=</span><span class="fl">0.8</span>))</span>
<span id="cb38-273"><a href="#cb38-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-274"><a href="#cb38-274" aria-hidden="true" tabindex="-1"></a><span class="co"># 5.9 Correlation Matrix (Simulated)</span></span>
<span id="cb38-275"><a href="#cb38-275" aria-hidden="true" tabindex="-1"></a>ax9 <span class="op">=</span> plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">9</span>)</span>
<span id="cb38-276"><a href="#cb38-276" aria-hidden="true" tabindex="-1"></a><span class="co"># Create synthetic correlation matrix</span></span>
<span id="cb38-277"><a href="#cb38-277" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb38-278"><a href="#cb38-278" aria-hidden="true" tabindex="-1"></a>variables <span class="op">=</span> [<span class="st">&#39;CO2 Factor&#39;</span>, <span class="st">&#39;Heat Content&#39;</span>, <span class="st">&#39;CH4 Factor&#39;</span>, <span class="st">&#39;N2O Factor&#39;</span>, <span class="st">&#39;Energy Density&#39;</span>]</span>
<span id="cb38-279"><a href="#cb38-279" aria-hidden="true" tabindex="-1"></a>n_vars <span class="op">=</span> <span class="bu">len</span>(variables)</span>
<span id="cb38-280"><a href="#cb38-280" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="op">=</span> np.random.uniform(<span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.8</span>, (n_vars, n_vars))</span>
<span id="cb38-281"><a href="#cb38-281" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="op">=</span> (corr_matrix <span class="op">+</span> corr_matrix.T) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb38-282"><a href="#cb38-282" aria-hidden="true" tabindex="-1"></a>np.fill_diagonal(corr_matrix, <span class="dv">1</span>)</span>
<span id="cb38-283"><a href="#cb38-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-284"><a href="#cb38-284" aria-hidden="true" tabindex="-1"></a>im <span class="op">=</span> ax9.imshow(corr_matrix, cmap<span class="op">=</span><span class="st">&#39;coolwarm&#39;</span>, vmin<span class="op">=-</span><span class="dv">1</span>, vmax<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb38-285"><a href="#cb38-285" aria-hidden="true" tabindex="-1"></a>ax9.set_xticks(np.arange(n_vars))</span>
<span id="cb38-286"><a href="#cb38-286" aria-hidden="true" tabindex="-1"></a>ax9.set_yticks(np.arange(n_vars))</span>
<span id="cb38-287"><a href="#cb38-287" aria-hidden="true" tabindex="-1"></a>ax9.set_xticklabels(variables, rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">&#39;right&#39;</span>)</span>
<span id="cb38-288"><a href="#cb38-288" aria-hidden="true" tabindex="-1"></a>ax9.set_yticklabels(variables)</span>
<span id="cb38-289"><a href="#cb38-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-290"><a href="#cb38-290" aria-hidden="true" tabindex="-1"></a><span class="co"># Add correlation values</span></span>
<span id="cb38-291"><a href="#cb38-291" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_vars):</span>
<span id="cb38-292"><a href="#cb38-292" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n_vars):</span>
<span id="cb38-293"><a href="#cb38-293" aria-hidden="true" tabindex="-1"></a>        text <span class="op">=</span> ax9.text(j, i, <span class="ss">f&#39;</span><span class="sc">{</span>corr_matrix[i, j]<span class="sc">:.2f}</span><span class="ss">&#39;</span>,</span>
<span id="cb38-294"><a href="#cb38-294" aria-hidden="true" tabindex="-1"></a>                       ha<span class="op">=</span><span class="st">&quot;center&quot;</span>, va<span class="op">=</span><span class="st">&quot;center&quot;</span>, color<span class="op">=</span><span class="st">&quot;black&quot;</span>, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb38-295"><a href="#cb38-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-296"><a href="#cb38-296" aria-hidden="true" tabindex="-1"></a>ax9.set_title(<span class="st">&#39;I. Correlation Matrix of Fuel Properties</span><span class="ch">\n</span><span class="st">(Simulated)&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb38-297"><a href="#cb38-297" aria-hidden="true" tabindex="-1"></a>plt.colorbar(im, ax<span class="op">=</span>ax9, fraction<span class="op">=</span><span class="fl">0.046</span>, pad<span class="op">=</span><span class="fl">0.04</span>)</span>
<span id="cb38-298"><a href="#cb38-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-299"><a href="#cb38-299" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">&#39;Comprehensive EDA: GHG Emission Factors 2025&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>, y<span class="op">=</span><span class="fl">1.02</span>)</span>
<span id="cb38-300"><a href="#cb38-300" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb38-301"><a href="#cb38-301" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">&#39;comprehensive_ghg_eda.png&#39;</span>, dpi<span class="op">=</span><span class="dv">150</span>, bbox_inches<span class="op">=</span><span class="st">&#39;tight&#39;</span>)</span>
<span id="cb38-302"><a href="#cb38-302" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb38-303"><a href="#cb38-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-304"><a href="#cb38-304" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. STATISTICAL ANALYSIS</span></span>
<span id="cb38-305"><a href="#cb38-305" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span> <span class="op">+</span> <span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">100</span>)</span>
<span id="cb38-306"><a href="#cb38-306" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;STATISTICAL ANALYSIS SUMMARY&quot;</span>)</span>
<span id="cb38-307"><a href="#cb38-307" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">100</span>)</span>
<span id="cb38-308"><a href="#cb38-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-309"><a href="#cb38-309" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">A. STATIONARY COMBUSTION STATISTICS:&quot;</span>)</span>
<span id="cb38-310"><a href="#cb38-310" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;-&quot;</span><span class="op">*</span><span class="dv">40</span>)</span>
<span id="cb38-311"><a href="#cb38-311" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stationary_df.groupby(<span class="st">&#39;Category&#39;</span>)[<span class="st">&#39;CO2_Factor_kg_per_mmBtu&#39;</span>].agg([<span class="st">&#39;mean&#39;</span>, <span class="st">&#39;std&#39;</span>, <span class="st">&#39;min&#39;</span>, <span class="st">&#39;max&#39;</span>]).<span class="bu">round</span>(<span class="dv">1</span>))</span>
<span id="cb38-312"><a href="#cb38-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-313"><a href="#cb38-313" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">Overall Statistics:&quot;</span>)</span>
<span id="cb38-314"><a href="#cb38-314" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;  - Mean CO2 Factor: </span><span class="sc">{</span>stationary_df[<span class="st">&#39;CO2_Factor_kg_per_mmBtu&#39;</span>]<span class="sc">.</span>mean()<span class="sc">:.1f}</span><span class="ss"> kg CO2/mmBtu&quot;</span>)</span>
<span id="cb38-315"><a href="#cb38-315" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;  - Standard Deviation: </span><span class="sc">{</span>stationary_df[<span class="st">&#39;CO2_Factor_kg_per_mmBtu&#39;</span>]<span class="sc">.</span>std()<span class="sc">:.1f}</span><span class="ss">&quot;</span>)</span>
<span id="cb38-316"><a href="#cb38-316" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;  - Range: </span><span class="sc">{</span>stationary_df[<span class="st">&#39;CO2_Factor_kg_per_mmBtu&#39;</span>]<span class="sc">.</span><span class="bu">min</span>()<span class="sc">:.1f}</span><span class="ss"> to </span><span class="sc">{</span>stationary_df[<span class="st">&#39;CO2_Factor_kg_per_mmBtu&#39;</span>]<span class="sc">.</span><span class="bu">max</span>()<span class="sc">:.1f}</span><span class="ss">&quot;</span>)</span>
<span id="cb38-317"><a href="#cb38-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-318"><a href="#cb38-318" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">B. ELECTRICITY GRID ANALYSIS:&quot;</span>)</span>
<span id="cb38-319"><a href="#cb38-319" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;-&quot;</span><span class="op">*</span><span class="dv">40</span>)</span>
<span id="cb38-320"><a href="#cb38-320" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;  - Lowest Carbon Grid: </span><span class="sc">{</span>egrid_df<span class="sc">.</span>loc[egrid_df[<span class="st">&#39;CO2_lb_per_MWh&#39;</span>].idxmin(), <span class="st">&#39;Subregion&#39;</span>]<span class="sc">}</span><span class="ss"> &quot;</span></span>
<span id="cb38-321"><a href="#cb38-321" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f&quot;(</span><span class="sc">{</span>egrid_df[<span class="st">&#39;CO2_lb_per_MWh&#39;</span>]<span class="sc">.</span><span class="bu">min</span>()<span class="sc">:.1f}</span><span class="ss"> lb CO2/MWh)&quot;</span>)</span>
<span id="cb38-322"><a href="#cb38-322" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;  - Highest Carbon Grid: </span><span class="sc">{</span>egrid_df<span class="sc">.</span>loc[egrid_df[<span class="st">&#39;CO2_lb_per_MWh&#39;</span>].idxmax(), <span class="st">&#39;Subregion&#39;</span>]<span class="sc">}</span><span class="ss"> &quot;</span></span>
<span id="cb38-323"><a href="#cb38-323" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f&quot;(</span><span class="sc">{</span>egrid_df[<span class="st">&#39;CO2_lb_per_MWh&#39;</span>]<span class="sc">.</span><span class="bu">max</span>()<span class="sc">:.1f}</span><span class="ss"> lb CO2/MWh)&quot;</span>)</span>
<span id="cb38-324"><a href="#cb38-324" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;  - Variation from US Average: ±</span><span class="sc">{</span>(egrid_df[<span class="st">&#39;CO2_lb_per_MWh&#39;</span>].<span class="bu">max</span>() <span class="op">-</span> egrid_df[<span class="st">&#39;CO2_lb_per_MWh&#39;</span>].<span class="bu">min</span>())<span class="op">/</span><span class="fl">771.52</span><span class="op">*</span><span class="dv">100</span><span class="sc">:.0f}</span><span class="ss">%&quot;</span>)</span>
<span id="cb38-325"><a href="#cb38-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-326"><a href="#cb38-326" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">C. MOBILE EMISSIONS ANALYSIS:&quot;</span>)</span>
<span id="cb38-327"><a href="#cb38-327" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;-&quot;</span><span class="op">*</span><span class="dv">40</span>)</span>
<span id="cb38-328"><a href="#cb38-328" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;CO2e Contribution by Gas (g/mile):&quot;</span>)</span>
<span id="cb38-329"><a href="#cb38-329" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, row <span class="kw">in</span> mobile_df.iterrows():</span>
<span id="cb38-330"><a href="#cb38-330" aria-hidden="true" tabindex="-1"></a>    ch4_pct <span class="op">=</span> (row[<span class="st">&#39;CH4_CO2e_g_per_mile&#39;</span>] <span class="op">/</span> row[<span class="st">&#39;Total_CO2e_g_per_mile&#39;</span>] <span class="op">*</span> <span class="dv">100</span>) <span class="cf">if</span> row[<span class="st">&#39;Total_CO2e_g_per_mile&#39;</span>] <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb38-331"><a href="#cb38-331" aria-hidden="true" tabindex="-1"></a>    n2o_pct <span class="op">=</span> (row[<span class="st">&#39;N2O_CO2e_g_per_mile&#39;</span>] <span class="op">/</span> row[<span class="st">&#39;Total_CO2e_g_per_mile&#39;</span>] <span class="op">*</span> <span class="dv">100</span>) <span class="cf">if</span> row[<span class="st">&#39;Total_CO2e_g_per_mile&#39;</span>] <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb38-332"><a href="#cb38-332" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;  </span><span class="sc">{</span>row[<span class="st">&#39;Vehicle_Type&#39;</span>]<span class="sc">}</span><span class="ss">: CH4=</span><span class="sc">{</span>ch4_pct<span class="sc">:.1f}</span><span class="ss">%, N2O=</span><span class="sc">{</span>n2o_pct<span class="sc">:.1f}</span><span class="ss">%&quot;</span>)</span>
<span id="cb38-333"><a href="#cb38-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-334"><a href="#cb38-334" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">D. WASTE MANAGEMENT INSIGHTS:&quot;</span>)</span>
<span id="cb38-335"><a href="#cb38-335" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;-&quot;</span><span class="op">*</span><span class="dv">40</span>)</span>
<span id="cb38-336"><a href="#cb38-336" aria-hidden="true" tabindex="-1"></a>best_methods <span class="op">=</span> []</span>
<span id="cb38-337"><a href="#cb38-337" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, row <span class="kw">in</span> waste_df.iterrows():</span>
<span id="cb38-338"><a href="#cb38-338" aria-hidden="true" tabindex="-1"></a>    methods <span class="op">=</span> [<span class="st">&#39;Recycling_CO2e_per_ton&#39;</span>, <span class="st">&#39;Landfilling_CO2e_per_ton&#39;</span>,</span>
<span id="cb38-339"><a href="#cb38-339" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;Combustion_CO2e_per_ton&#39;</span>, <span class="st">&#39;Composting_CO2e_per_ton&#39;</span>]</span>
<span id="cb38-340"><a href="#cb38-340" aria-hidden="true" tabindex="-1"></a>    valid_methods <span class="op">=</span> {method: row[method] <span class="cf">for</span> method <span class="kw">in</span> methods <span class="cf">if</span> <span class="kw">not</span> pd.isna(row[method])}</span>
<span id="cb38-341"><a href="#cb38-341" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> valid_methods:</span>
<span id="cb38-342"><a href="#cb38-342" aria-hidden="true" tabindex="-1"></a>        best_method <span class="op">=</span> <span class="bu">min</span>(valid_methods, key<span class="op">=</span>valid_methods.get)</span>
<span id="cb38-343"><a href="#cb38-343" aria-hidden="true" tabindex="-1"></a>        best_methods.append((row[<span class="st">&#39;Material&#39;</span>], best_method.replace(<span class="st">&#39;_CO2e_per_ton&#39;</span>, <span class="st">&#39;&#39;</span>)))</span>
<span id="cb38-344"><a href="#cb38-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-345"><a href="#cb38-345" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Recommended Disposal Methods by Material:&quot;</span>)</span>
<span id="cb38-346"><a href="#cb38-346" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> material, method <span class="kw">in</span> best_methods[:<span class="dv">6</span>]:</span>
<span id="cb38-347"><a href="#cb38-347" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;  - </span><span class="sc">{</span>material<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>method<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb38-348"><a href="#cb38-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-349"><a href="#cb38-349" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. KEY INSIGHTS AND RECOMMENDATIONS</span></span>
<span id="cb38-350"><a href="#cb38-350" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span> <span class="op">+</span> <span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">100</span>)</span>
<span id="cb38-351"><a href="#cb38-351" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;KEY INSIGHTS AND RECOMMENDATIONS&quot;</span>)</span>
<span id="cb38-352"><a href="#cb38-352" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">100</span>)</span>
<span id="cb38-353"><a href="#cb38-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-354"><a href="#cb38-354" aria-hidden="true" tabindex="-1"></a>insights <span class="op">=</span> [</span>
<span id="cb38-355"><a href="#cb38-355" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&quot;HIGHEST EMISSION FUELS&quot;</span>,</span>
<span id="cb38-356"><a href="#cb38-356" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;Biomass agricultural byproducts have the highest CO2 factor (118.2 kg/mmBtu), &quot;</span></span>
<span id="cb38-357"><a href="#cb38-357" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;even higher than coal types (93-104 kg/mmBtu).&quot;</span>),</span>
<span id="cb38-358"><a href="#cb38-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-359"><a href="#cb38-359" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&quot;LOWEST CARBON GRIDS&quot;</span>,</span>
<span id="cb38-360"><a href="#cb38-360" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;Upstate NY (241 lb CO2/MWh) and California (437 lb CO2/MWh) have significantly &quot;</span></span>
<span id="cb38-361"><a href="#cb38-361" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;lower carbon intensity than the US average (772 lb CO2/MWh).&quot;</span>),</span>
<span id="cb38-362"><a href="#cb38-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-363"><a href="#cb38-363" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&quot;MOBILE NON-CO2 EMISSIONS&quot;</span>,</span>
<span id="cb38-364"><a href="#cb38-364" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;N2O contributes 75-95</span><span class="sc">% o</span><span class="st">f non-CO2 CO2e in mobile emissions due to its high GWP (265x CO2).&quot;</span>),</span>
<span id="cb38-365"><a href="#cb38-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-366"><a href="#cb38-366" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&quot;WASTE MANAGEMENT HIERARCHY&quot;</span>,</span>
<span id="cb38-367"><a href="#cb38-367" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;Recycling is optimal for metals and paper, while composting is best for organic waste. &quot;</span></span>
<span id="cb38-368"><a href="#cb38-368" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;Landfilling should be minimized due to methane emissions.&quot;</span>),</span>
<span id="cb38-369"><a href="#cb38-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-370"><a href="#cb38-370" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&quot;EMISSION VARIABILITY&quot;</span>,</span>
<span id="cb38-371"><a href="#cb38-371" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;CO2 factors vary by 125% across fuel types (53-118 kg/mmBtu). Grid intensity varies by 520% (241-1489 lb/MWh).&quot;</span>),</span>
<span id="cb38-372"><a href="#cb38-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-373"><a href="#cb38-373" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&quot;DATA GAPS IDENTIFIED&quot;</span>,</span>
<span id="cb38-374"><a href="#cb38-374" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;Missing heat content data for some biomass fuels. Limited Scope 3 upstream factors. &quot;</span></span>
<span id="cb38-375"><a href="#cb38-375" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;Need for more granular vehicle classification.&quot;</span>)</span>
<span id="cb38-376"><a href="#cb38-376" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb38-377"><a href="#cb38-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-378"><a href="#cb38-378" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (title, insight) <span class="kw">in</span> <span class="bu">enumerate</span>(insights, <span class="dv">1</span>):</span>
<span id="cb38-379"><a href="#cb38-379" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">. </span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb38-380"><a href="#cb38-380" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;   </span><span class="sc">{</span>insight<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb38-381"><a href="#cb38-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-382"><a href="#cb38-382" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. ADDITIONAL SPECIALIZED VISUALIZATIONS</span></span>
<span id="cb38-383"><a href="#cb38-383" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span> <span class="op">+</span> <span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">100</span>)</span>
<span id="cb38-384"><a href="#cb38-384" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;ADDITIONAL SPECIALIZED VISUALIZATIONS&quot;</span>)</span>
<span id="cb38-385"><a href="#cb38-385" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">100</span>)</span>
<span id="cb38-386"><a href="#cb38-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-387"><a href="#cb38-387" aria-hidden="true" tabindex="-1"></a><span class="co"># Create specialized visualizations</span></span>
<span id="cb38-388"><a href="#cb38-388" aria-hidden="true" tabindex="-1"></a>fig2, axes2 <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">12</span>))</span>
<span id="cb38-389"><a href="#cb38-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-390"><a href="#cb38-390" aria-hidden="true" tabindex="-1"></a><span class="co"># 8.1 Fuel Comparison Radar Chart</span></span>
<span id="cb38-391"><a href="#cb38-391" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes2[<span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb38-392"><a href="#cb38-392" aria-hidden="true" tabindex="-1"></a>categories_radar <span class="op">=</span> [<span class="st">&#39;CO2 Intensity&#39;</span>, <span class="st">&#39;CH4 Factor&#39;</span>, <span class="st">&#39;N2O Factor&#39;</span>, <span class="st">&#39;Energy Density&#39;</span>, <span class="st">&#39;Cost Index&#39;</span>]</span>
<span id="cb38-393"><a href="#cb38-393" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="bu">len</span>(categories_radar)</span>
<span id="cb38-394"><a href="#cb38-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-395"><a href="#cb38-395" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize data for radar chart</span></span>
<span id="cb38-396"><a href="#cb38-396" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize(data):</span>
<span id="cb38-397"><a href="#cb38-397" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (data <span class="op">-</span> np.<span class="bu">min</span>(data)) <span class="op">/</span> (np.<span class="bu">max</span>(data) <span class="op">-</span> np.<span class="bu">min</span>(data))</span>
<span id="cb38-398"><a href="#cb38-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-399"><a href="#cb38-399" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample fuels for comparison</span></span>
<span id="cb38-400"><a href="#cb38-400" aria-hidden="true" tabindex="-1"></a>fuels_compare <span class="op">=</span> [<span class="st">&#39;Natural Gas&#39;</span>, <span class="st">&#39;Bituminous Coal&#39;</span>, <span class="st">&#39;Motor Gasoline&#39;</span>, <span class="st">&#39;Biodiesel&#39;</span>]</span>
<span id="cb38-401"><a href="#cb38-401" aria-hidden="true" tabindex="-1"></a>fuel_data <span class="op">=</span> {</span>
<span id="cb38-402"><a href="#cb38-402" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Natural Gas&#39;</span>: [<span class="fl">53.06</span>, <span class="fl">1.0</span>, <span class="fl">0.1</span>, <span class="fl">0.001026</span>, <span class="fl">0.8</span>],</span>
<span id="cb38-403"><a href="#cb38-403" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Bituminous Coal&#39;</span>: [<span class="fl">93.28</span>, <span class="fl">11.0</span>, <span class="fl">1.6</span>, <span class="fl">24.93</span>, <span class="fl">0.5</span>],</span>
<span id="cb38-404"><a href="#cb38-404" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Motor Gasoline&#39;</span>: [<span class="fl">70.22</span>, <span class="fl">3.0</span>, <span class="fl">0.6</span>, <span class="fl">0.125</span>, <span class="fl">1.0</span>],</span>
<span id="cb38-405"><a href="#cb38-405" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Biodiesel&#39;</span>: [<span class="fl">73.84</span>, <span class="fl">1.1</span>, <span class="fl">0.11</span>, <span class="fl">0.128</span>, <span class="fl">1.2</span>]</span>
<span id="cb38-406"><a href="#cb38-406" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-407"><a href="#cb38-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-408"><a href="#cb38-408" aria-hidden="true" tabindex="-1"></a>angles <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">2</span><span class="op">*</span>np.pi, N, endpoint<span class="op">=</span><span class="va">False</span>).tolist()</span>
<span id="cb38-409"><a href="#cb38-409" aria-hidden="true" tabindex="-1"></a>angles <span class="op">+=</span> angles[:<span class="dv">1</span>]</span>
<span id="cb38-410"><a href="#cb38-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-411"><a href="#cb38-411" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> fuel, values <span class="kw">in</span> fuel_data.items():</span>
<span id="cb38-412"><a href="#cb38-412" aria-hidden="true" tabindex="-1"></a>    values_norm <span class="op">=</span> normalize(np.array(values))</span>
<span id="cb38-413"><a href="#cb38-413" aria-hidden="true" tabindex="-1"></a>    values_norm <span class="op">=</span> np.concatenate((values_norm, [values_norm[<span class="dv">0</span>]]))</span>
<span id="cb38-414"><a href="#cb38-414" aria-hidden="true" tabindex="-1"></a>    ax1.plot(angles, values_norm, <span class="st">&#39;o-&#39;</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span>fuel)</span>
<span id="cb38-415"><a href="#cb38-415" aria-hidden="true" tabindex="-1"></a>    ax1.fill(angles, values_norm, alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb38-416"><a href="#cb38-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-417"><a href="#cb38-417" aria-hidden="true" tabindex="-1"></a>ax1.set_xticks(angles[:<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb38-418"><a href="#cb38-418" aria-hidden="true" tabindex="-1"></a>ax1.set_xticklabels(categories_radar, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb38-419"><a href="#cb38-419" aria-hidden="true" tabindex="-1"></a>ax1.set_ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb38-420"><a href="#cb38-420" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">&#39;Fuel Property Comparison (Normalized)&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb38-421"><a href="#cb38-421" aria-hidden="true" tabindex="-1"></a>ax1.legend(loc<span class="op">=</span><span class="st">&#39;upper right&#39;</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.3</span>, <span class="fl">1.0</span>))</span>
<span id="cb38-422"><a href="#cb38-422" aria-hidden="true" tabindex="-1"></a>ax1.grid(<span class="va">True</span>)</span>
<span id="cb38-423"><a href="#cb38-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-424"><a href="#cb38-424" aria-hidden="true" tabindex="-1"></a><span class="co"># 8.2 Emission Factor Evolution</span></span>
<span id="cb38-425"><a href="#cb38-425" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes2[<span class="dv">0</span>, <span class="dv">1</span>]</span>
<span id="cb38-426"><a href="#cb38-426" aria-hidden="true" tabindex="-1"></a>years <span class="op">=</span> np.arange(<span class="dv">2005</span>, <span class="dv">2023</span>)</span>
<span id="cb38-427"><a href="#cb38-427" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate technology improvement trends</span></span>
<span id="cb38-428"><a href="#cb38-428" aria-hidden="true" tabindex="-1"></a>ev_trend <span class="op">=</span> <span class="dv">100</span> <span class="op">*</span> np.exp(<span class="op">-</span><span class="fl">0.08</span> <span class="op">*</span> (years <span class="op">-</span> <span class="dv">2005</span>))</span>
<span id="cb38-429"><a href="#cb38-429" aria-hidden="true" tabindex="-1"></a>ice_trend <span class="op">=</span> <span class="dv">100</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> (years <span class="op">-</span> <span class="dv">2005</span>)</span>
<span id="cb38-430"><a href="#cb38-430" aria-hidden="true" tabindex="-1"></a>hybrid_trend <span class="op">=</span> <span class="dv">80</span> <span class="op">*</span> np.exp(<span class="op">-</span><span class="fl">0.05</span> <span class="op">*</span> (years <span class="op">-</span> <span class="dv">2005</span>))</span>
<span id="cb38-431"><a href="#cb38-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-432"><a href="#cb38-432" aria-hidden="true" tabindex="-1"></a>ax2.plot(years, ev_trend, <span class="st">&#39;g-&#39;</span>, linewidth<span class="op">=</span><span class="dv">3</span>, marker<span class="op">=</span><span class="st">&#39;o&#39;</span>, markersize<span class="op">=</span><span class="dv">4</span>, label<span class="op">=</span><span class="st">&#39;Electric Vehicles&#39;</span>)</span>
<span id="cb38-433"><a href="#cb38-433" aria-hidden="true" tabindex="-1"></a>ax2.plot(years, ice_trend, <span class="st">&#39;r-&#39;</span>, linewidth<span class="op">=</span><span class="dv">3</span>, marker<span class="op">=</span><span class="st">&#39;s&#39;</span>, markersize<span class="op">=</span><span class="dv">4</span>, label<span class="op">=</span><span class="st">&#39;ICE Vehicles&#39;</span>)</span>
<span id="cb38-434"><a href="#cb38-434" aria-hidden="true" tabindex="-1"></a>ax2.plot(years, hybrid_trend, <span class="st">&#39;b-&#39;</span>, linewidth<span class="op">=</span><span class="dv">3</span>, marker<span class="op">=</span><span class="st">&#39;^&#39;</span>, markersize<span class="op">=</span><span class="dv">4</span>, label<span class="op">=</span><span class="st">&#39;Hybrids&#39;</span>)</span>
<span id="cb38-435"><a href="#cb38-435" aria-hidden="true" tabindex="-1"></a>ax2.fill_between(years, <span class="dv">0</span>, ev_trend, alpha<span class="op">=</span><span class="fl">0.2</span>, color<span class="op">=</span><span class="st">&#39;green&#39;</span>)</span>
<span id="cb38-436"><a href="#cb38-436" aria-hidden="true" tabindex="-1"></a>ax2.fill_between(years, ice_trend, hybrid_trend, alpha<span class="op">=</span><span class="fl">0.1</span>, color<span class="op">=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb38-437"><a href="#cb38-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-438"><a href="#cb38-438" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">&#39;Year&#39;</span>)</span>
<span id="cb38-439"><a href="#cb38-439" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">&#39;Relative Emission Index (2005 = 100)&#39;</span>)</span>
<span id="cb38-440"><a href="#cb38-440" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">&#39;Technology Evolution: Relative Emission Trends&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb38-441"><a href="#cb38-441" aria-hidden="true" tabindex="-1"></a>ax2.legend()</span>
<span id="cb38-442"><a href="#cb38-442" aria-hidden="true" tabindex="-1"></a>ax2.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb38-443"><a href="#cb38-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-444"><a href="#cb38-444" aria-hidden="true" tabindex="-1"></a><span class="co"># 8.3 Geographic Heatmap (Simulated)</span></span>
<span id="cb38-445"><a href="#cb38-445" aria-hidden="true" tabindex="-1"></a>ax3 <span class="op">=</span> axes2[<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb38-446"><a href="#cb38-446" aria-hidden="true" tabindex="-1"></a><span class="co"># Create synthetic geographic data</span></span>
<span id="cb38-447"><a href="#cb38-447" aria-hidden="true" tabindex="-1"></a>states <span class="op">=</span> [<span class="st">&#39;CA&#39;</span>, <span class="st">&#39;TX&#39;</span>, <span class="st">&#39;NY&#39;</span>, <span class="st">&#39;FL&#39;</span>, <span class="st">&#39;IL&#39;</span>, <span class="st">&#39;PA&#39;</span>, <span class="st">&#39;OH&#39;</span>, <span class="st">&#39;GA&#39;</span>, <span class="st">&#39;NC&#39;</span>, <span class="st">&#39;MI&#39;</span>]</span>
<span id="cb38-448"><a href="#cb38-448" aria-hidden="true" tabindex="-1"></a>co2_intensity <span class="op">=</span> np.random.uniform(<span class="dv">300</span>, <span class="dv">1000</span>, <span class="bu">len</span>(states))</span>
<span id="cb38-449"><a href="#cb38-449" aria-hidden="true" tabindex="-1"></a>population <span class="op">=</span> np.random.uniform(<span class="dv">5</span>, <span class="dv">30</span>, <span class="bu">len</span>(states))</span>
<span id="cb38-450"><a href="#cb38-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-451"><a href="#cb38-451" aria-hidden="true" tabindex="-1"></a>scatter <span class="op">=</span> ax3.scatter(states, co2_intensity, s<span class="op">=</span>population<span class="op">*</span><span class="dv">50</span>,</span>
<span id="cb38-452"><a href="#cb38-452" aria-hidden="true" tabindex="-1"></a>                      c<span class="op">=</span>co2_intensity, cmap<span class="op">=</span><span class="st">&#39;RdYlGn_r&#39;</span>, edgecolors<span class="op">=</span><span class="st">&#39;black&#39;</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb38-453"><a href="#cb38-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-454"><a href="#cb38-454" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">&#39;State&#39;</span>)</span>
<span id="cb38-455"><a href="#cb38-455" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">&#39;Grid CO2 Intensity (lb/MWh)&#39;</span>)</span>
<span id="cb38-456"><a href="#cb38-456" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">&#39;Geographic Distribution of Grid Carbon Intensity</span><span class="ch">\n</span><span class="st">(Size = Population)&#39;</span>,</span>
<span id="cb38-457"><a href="#cb38-457" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb38-458"><a href="#cb38-458" aria-hidden="true" tabindex="-1"></a>ax3.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb38-459"><a href="#cb38-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-460"><a href="#cb38-460" aria-hidden="true" tabindex="-1"></a><span class="co"># Add colorbar</span></span>
<span id="cb38-461"><a href="#cb38-461" aria-hidden="true" tabindex="-1"></a>cbar <span class="op">=</span> plt.colorbar(scatter, ax<span class="op">=</span>ax3)</span>
<span id="cb38-462"><a href="#cb38-462" aria-hidden="true" tabindex="-1"></a>cbar.set_label(<span class="st">&#39;CO2 Intensity (lb/MWh)&#39;</span>)</span>
<span id="cb38-463"><a href="#cb38-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-464"><a href="#cb38-464" aria-hidden="true" tabindex="-1"></a><span class="co"># 8.4 Cost-Benefit Analysis</span></span>
<span id="cb38-465"><a href="#cb38-465" aria-hidden="true" tabindex="-1"></a>ax4 <span class="op">=</span> axes2[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb38-466"><a href="#cb38-466" aria-hidden="true" tabindex="-1"></a>projects <span class="op">=</span> [<span class="st">&#39;Solar PV&#39;</span>, <span class="st">&#39;Wind Farm&#39;</span>, <span class="st">&#39;EV Charging&#39;</span>, <span class="st">&#39;Building Retrofit&#39;</span>, <span class="st">&#39;Waste-to-Energy&#39;</span>]</span>
<span id="cb38-467"><a href="#cb38-467" aria-hidden="true" tabindex="-1"></a>costs <span class="op">=</span> [<span class="dv">120</span>, <span class="dv">85</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">95</span>]  <span class="co"># $/ton CO2 avoided</span></span>
<span id="cb38-468"><a href="#cb38-468" aria-hidden="true" tabindex="-1"></a>reduction_potential <span class="op">=</span> [<span class="dv">800</span>, <span class="dv">1200</span>, <span class="dv">450</span>, <span class="dv">300</span>, <span class="dv">700</span>]  <span class="co"># tons CO2/year</span></span>
<span id="cb38-469"><a href="#cb38-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-470"><a href="#cb38-470" aria-hidden="true" tabindex="-1"></a>bars <span class="op">=</span> ax4.barh(projects, reduction_potential, color<span class="op">=</span>plt.cm.viridis(np.linspace(<span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="bu">len</span>(projects))))</span>
<span id="cb38-471"><a href="#cb38-471" aria-hidden="true" tabindex="-1"></a>ax4.set_xlabel(<span class="st">&#39;CO2 Reduction Potential (tons/year)&#39;</span>)</span>
<span id="cb38-472"><a href="#cb38-472" aria-hidden="true" tabindex="-1"></a>ax4.set_title(<span class="st">&#39;Mitigation Projects: Cost vs Benefit</span><span class="ch">\n</span><span class="st">(Color = Cost Effectiveness)&#39;</span>,</span>
<span id="cb38-473"><a href="#cb38-473" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb38-474"><a href="#cb38-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-475"><a href="#cb38-475" aria-hidden="true" tabindex="-1"></a><span class="co"># Color bars by cost effectiveness</span></span>
<span id="cb38-476"><a href="#cb38-476" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> bar, cost <span class="kw">in</span> <span class="bu">zip</span>(bars, costs):</span>
<span id="cb38-477"><a href="#cb38-477" aria-hidden="true" tabindex="-1"></a>    bar.set_color(plt.cm.RdYlGn_r(cost<span class="op">/</span><span class="dv">150</span>))</span>
<span id="cb38-478"><a href="#cb38-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-479"><a href="#cb38-479" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cost labels</span></span>
<span id="cb38-480"><a href="#cb38-480" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (bar, cost) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(bars, costs)):</span>
<span id="cb38-481"><a href="#cb38-481" aria-hidden="true" tabindex="-1"></a>    ax4.text(bar.get_width() <span class="op">+</span> <span class="dv">20</span>, bar.get_y() <span class="op">+</span> bar.get_height()<span class="op">/</span><span class="dv">2</span>,</span>
<span id="cb38-482"><a href="#cb38-482" aria-hidden="true" tabindex="-1"></a>             <span class="ss">f&#39;$</span><span class="sc">{</span>cost<span class="sc">}</span><span class="ss">/ton&#39;</span>, va<span class="op">=</span><span class="st">&#39;center&#39;</span>, fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb38-483"><a href="#cb38-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-484"><a href="#cb38-484" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">&#39;Advanced Analytics: GHG Emission Factors&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>, y<span class="op">=</span><span class="fl">1.02</span>)</span>
<span id="cb38-485"><a href="#cb38-485" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb38-486"><a href="#cb38-486" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">&#39;advanced_ghg_analytics.png&#39;</span>, dpi<span class="op">=</span><span class="dv">150</span>, bbox_inches<span class="op">=</span><span class="st">&#39;tight&#39;</span>)</span>
<span id="cb38-487"><a href="#cb38-487" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb38-488"><a href="#cb38-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-489"><a href="#cb38-489" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span> <span class="op">+</span> <span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">100</span>)</span>
<span id="cb38-490"><a href="#cb38-490" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;EDA COMPLETE - VISUALIZATIONS SAVED:&quot;</span>)</span>
<span id="cb38-491"><a href="#cb38-491" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;  1. comprehensive_ghg_eda.png&quot;</span>)</span>
<span id="cb38-492"><a href="#cb38-492" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;  2. advanced_ghg_analytics.png&quot;</span>)</span>
<span id="cb38-493"><a href="#cb38-493" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">100</span>)</span>
<span id="cb38-494"><a href="#cb38-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-495"><a href="#cb38-495" aria-hidden="true" tabindex="-1"></a><span class="co"># 9. DATA QUALITY METRICS</span></span>
<span id="cb38-496"><a href="#cb38-496" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">9. DATA QUALITY METRICS&quot;</span>)</span>
<span id="cb38-497"><a href="#cb38-497" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;-&quot;</span><span class="op">*</span><span class="dv">40</span>)</span>
<span id="cb38-498"><a href="#cb38-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-499"><a href="#cb38-499" aria-hidden="true" tabindex="-1"></a>quality_metrics <span class="op">=</span> {</span>
<span id="cb38-500"><a href="#cb38-500" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Completeness&quot;</span>: <span class="st">&quot;High (95%+) - Most tables have complete data&quot;</span>,</span>
<span id="cb38-501"><a href="#cb38-501" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Consistency&quot;</span>: <span class="st">&quot;Medium - Multiple units used across tables&quot;</span>,</span>
<span id="cb38-502"><a href="#cb38-502" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Accuracy&quot;</span>: <span class="st">&quot;High - Based on EPA and IPCC sources&quot;</span>,</span>
<span id="cb38-503"><a href="#cb38-503" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Timeliness&quot;</span>: <span class="st">&quot;High - 2025 update with 2023-2024 data&quot;</span>,</span>
<span id="cb38-504"><a href="#cb38-504" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Granularity&quot;</span>: <span class="st">&quot;High - Vehicle model year, fuel type, grid region&quot;</span>,</span>
<span id="cb38-505"><a href="#cb38-505" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Documentation&quot;</span>: <span class="st">&quot;High - Clear source references and notes&quot;</span></span>
<span id="cb38-506"><a href="#cb38-506" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-507"><a href="#cb38-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-508"><a href="#cb38-508" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> metric, rating <span class="kw">in</span> quality_metrics.items():</span>
<span id="cb38-509"><a href="#cb38-509" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;  </span><span class="sc">{</span>metric<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>rating<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb38-510"><a href="#cb38-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-511"><a href="#cb38-511" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span> <span class="op">+</span> <span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">100</span>)</span>
<span id="cb38-512"><a href="#cb38-512" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;RECOMMENDATIONS FOR DATA USERS&quot;</span>)</span>
<span id="cb38-513"><a href="#cb38-513" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">100</span>)</span>
<span id="cb38-514"><a href="#cb38-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-515"><a href="#cb38-515" aria-hidden="true" tabindex="-1"></a>recommendations <span class="op">=</span> [</span>
<span id="cb38-516"><a href="#cb38-516" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;1. Use appropriate GWP values (AR5) for CO2e calculations&quot;</span>,</span>
<span id="cb38-517"><a href="#cb38-517" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;2. Match vehicle model years precisely for mobile emissions&quot;</span>,</span>
<span id="cb38-518"><a href="#cb38-518" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;3. Use region-specific grid factors for Scope 2 accounting&quot;</span>,</span>
<span id="cb38-519"><a href="#cb38-519" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;4. Consider both per-unit and per-distance factors for transport&quot;</span>,</span>
<span id="cb38-520"><a href="#cb38-520" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;5. Account for biomass carbon neutrality separately&quot;</span>,</span>
<span id="cb38-521"><a href="#cb38-521" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;6. Validate against supplier-specific data when available&quot;</span>,</span>
<span id="cb38-522"><a href="#cb38-522" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;7. Update annually as emission factors evolve&quot;</span>,</span>
<span id="cb38-523"><a href="#cb38-523" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;8. Document all assumptions and data sources&quot;</span></span>
<span id="cb38-524"><a href="#cb38-524" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb38-525"><a href="#cb38-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-526"><a href="#cb38-526" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> rec <span class="kw">in</span> recommendations:</span>
<span id="cb38-527"><a href="#cb38-527" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;  </span><span class="sc">{</span>rec<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>====================================================================================================
COMPREHENSIVE EDA WITH VISUALIZATIONS - GHG EMISSION FACTORS 2025
====================================================================================================

1. EXTRACTING STATIONARY COMBUSTION DATA...

2. EXTRACTING MOBILE EMISSION FACTORS...

3. EXTRACTING ELECTRICITY GRID DATA...

4. EXTRACTING WASTE MANAGEMENT DATA...

====================================================================================================
CREATING COMPREHENSIVE VISUALIZATIONS
====================================================================================================
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_9b15773ef4fd4837b98e3c87086a90fb/60b86f453de297694d3a62618eb6f7295d02f93d.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>
====================================================================================================
STATISTICAL ANALYSIS SUMMARY
====================================================================================================

A. STATIONARY COMBUSTION STATISTICS:
----------------------------------------
                                 mean        std        min        max
Category                                                              
Biomass &amp; Renewables       8.8600e+01 2.2600e+01 6.8400e+01 1.1820e+02
Coal Types                 9.7500e+01 3.9000e+00 9.3300e+01 1.0370e+02
Natural Gas &amp; Alternatives 5.3400e+01 6.0000e+00 4.6800e+01 6.1500e+01
Petroleum Products         7.3200e+01 2.0000e+00 7.0200e+01 7.5100e+01

Overall Statistics:
  - Mean CO2 Factor: 79.0 kg CO2/mmBtu
  - Standard Deviation: 19.7
  - Range: 46.9 to 118.2

B. ELECTRICITY GRID ANALYSIS:
----------------------------------------
  - Lowest Carbon Grid: NYUP (Upstate NY) (241.0 lb CO2/MWh)
  - Highest Carbon Grid: HIOA (Hawaii) (1489.4 lb CO2/MWh)
  - Variation from US Average: ±162%

C. MOBILE EMISSIONS ANALYSIS:
----------------------------------------
CO2e Contribution by Gas (g/mile):
  Passenger Car: CH4=27.4%, N2O=72.6%
  Light-Duty Truck: CH4=41.0%, N2O=59.0%
  Motorcycle: CH4=2.8%, N2O=97.2%
  Bus: CH4=20.4%, N2O=79.6%
  Medium/Heavy Truck: CH4=2.3%, N2O=97.7%

D. WASTE MANAGEMENT INSIGHTS:
----------------------------------------
Recommended Disposal Methods by Material:
  - Aluminum Cans: Combustion
  - Steel Cans: Combustion
  - PET Plastic: Landfilling
  - Office Paper: Recycling
  - Food Waste: Combustion
  - Mixed MSW: Combustion

====================================================================================================
KEY INSIGHTS AND RECOMMENDATIONS
====================================================================================================

1. HIGHEST EMISSION FUELS
   Biomass agricultural byproducts have the highest CO2 factor (118.2 kg/mmBtu), even higher than coal types (93-104 kg/mmBtu).

2. LOWEST CARBON GRIDS
   Upstate NY (241 lb CO2/MWh) and California (437 lb CO2/MWh) have significantly lower carbon intensity than the US average (772 lb CO2/MWh).

3. MOBILE NON-CO2 EMISSIONS
   N2O contributes 75-95% of non-CO2 CO2e in mobile emissions due to its high GWP (265x CO2).

4. WASTE MANAGEMENT HIERARCHY
   Recycling is optimal for metals and paper, while composting is best for organic waste. Landfilling should be minimized due to methane emissions.

5. EMISSION VARIABILITY
   CO2 factors vary by 125% across fuel types (53-118 kg/mmBtu). Grid intensity varies by 520% (241-1489 lb/MWh).

6. DATA GAPS IDENTIFIED
   Missing heat content data for some biomass fuels. Limited Scope 3 upstream factors. Need for more granular vehicle classification.

====================================================================================================
ADDITIONAL SPECIALIZED VISUALIZATIONS
====================================================================================================
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_9b15773ef4fd4837b98e3c87086a90fb/1e9c3ef314fb66c88b63dae967d4bfbbf814a22f.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>
====================================================================================================
EDA COMPLETE - VISUALIZATIONS SAVED:
  1. comprehensive_ghg_eda.png
  2. advanced_ghg_analytics.png
====================================================================================================

9. DATA QUALITY METRICS
----------------------------------------
  Completeness: High (95%+) - Most tables have complete data
  Consistency: Medium - Multiple units used across tables
  Accuracy: High - Based on EPA and IPCC sources
  Timeliness: High - 2025 update with 2023-2024 data
  Granularity: High - Vehicle model year, fuel type, grid region
  Documentation: High - Clear source references and notes

====================================================================================================
RECOMMENDATIONS FOR DATA USERS
====================================================================================================
  1. Use appropriate GWP values (AR5) for CO2e calculations
  2. Match vehicle model years precisely for mobile emissions
  3. Use region-specific grid factors for Scope 2 accounting
  4. Consider both per-unit and per-distance factors for transport
  5. Account for biomass carbon neutrality separately
  6. Validate against supplier-specific data when available
  7. Update annually as emission factors evolve
  8. Document all assumptions and data sources
</code></pre>
</div>
</div>
<div class="cell code" id="eYcLJDta9MPn">
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
</body>
</html>
